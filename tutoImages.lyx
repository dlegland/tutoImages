#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrreprt
\begin_preamble

\usepackage{xcolor}
\definecolor{bl}{rgb}{0.0,0.2,0.6} 


% package that modifies style of section headers
\addtokomafont{chapter}{\color{bl}\scshape \selectfont}
\addtokomafont{section}{\color{bl}\scshape \selectfont}
\addtokomafont{subsection}{\color{bl}\scshape \selectfont}
\addtokomafont{subsubsection}{\color{bl}\scshape \selectfont}
%\allsectionsfont{\color{bl}\scshape \selectfont }

% setup font style for different title elements
\setkomafont{title}{\color{bl} \bfseries \scshape}
\setkomafont{author}{\centering \small}
\setkomafont{date}{\centering \small}


% Change the abstract environment
\usepackage[runin]{abstract}			% runin option for a run-in title
\setlength\absleftindent{30pt}		% left margin
\setlength\absrightindent{30pt}		% right margin
\abslabeldelim{\quad }						% 
\setlength{\abstitleskip}{-10pt}
\renewcommand{\abstractname}{}
\renewcommand{\abstracttextfont}{\color{bl} \small \slshape }	% slanted text


% Custom headers and footers using KOMA-Script
\usepackage{scrlayer-scrpage}
\usepackage{lastpage}	% for page numbering	

% Left header: chapter title on even pages
\lehead{\slshape\leftmark}
\lohead{}
% Center header: empty
%\chead{}
% Right header: section title on odd pages
\rehead{}
\rohead{\slshape\rightmark}

% Outer footer (left of even pages, right of odd pages)
\KOMAoptions{footsepline=on}
\ofoot[\footnotesize page \thepage\ / \pageref{LastPage}]{\footnotesize page \thepage\ / \pageref{LastPage}}
% Center footer: empty
\cfoot{}
% Inner footer (right of even pages, left of odd pages)
\ifoot[\footnotesize \jobname]{\footnotesize \jobname}

% left chapter no number, nothing on the right
\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ #1}{}}
% right section with number
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}

% 
\usepackage[format=plain,labelfont=bf]{caption}
\captionsetup[figure]{name=Figure}
\DeclareCaptionLabelSeparator{colon}{: }

% To add mini-TOC in the beginning of each chapter
% The 'nohints' option is to prevent a conflict with the lastpage package, 
% resulting in an extra empty page at the end of the document.
\usepackage[nohints]{minitoc}



% some info for populating document title page
\author{D. Legland}
\date{\today}
\end_preamble
\options latin9,utf8
\use_default_options true
\maintain_unincluded_children false
\language french
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "beramono" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format pdf2
\output_sync 1
\bibtex_command default
\index_command default
\float_placement h
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3.5cm
\topmargin 4cm
\rightmargin 3.5cm
\bottommargin 3.5cm
\secnumdepth 3
\tocdepth 1
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style french
\dynamic_quotes 0
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Petit guide du traitement d'images 
\begin_inset Newline newline
\end_inset

à l'usage des biologistes
\end_layout

\begin_layout Abstract
Ce document présente une introduction à l'analyse et au traitement d'images
 dans un cadre scientifique, en particulier pour les sciences du vivant.
 Le public visé est le scientifique (chercheur, ingénieur ou technicien)
 qui a besoin d'outils pour analyser des images acquises dans le cadre de
 ses recherches.
 Le niveau mathématique requis est volontairement gardé faible, et dans
 la mesure du possible les exemples seront donnés en utilisant des images
 issues de recherches concrètes menées à l'INRA.
 
\end_layout

\begin_layout Abstract
\begin_inset Note Note
status open

\begin_layout Plain Layout
Le contenu de ce document est destiné à être transféré sur le site internet
 de la plateforme logicielle Cépia une fois qu'il sera finalisé.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
dominitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList figure

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Chapter
Introduction
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Trucs à faire :
\end_layout

\begin_layout Itemize
ajouter une biblio....
\end_layout

\begin_layout Itemize
ajouter un index ?
\end_layout

\begin_layout Itemize
organisation standard pour certaines fiches
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
problème / contexte
\end_layout

\begin_layout Itemize
algo utilisé
\end_layout

\begin_layout Itemize
exemple d'application
\end_layout

\begin_layout Itemize
implémentation Matlab/ImageJ/Visilog
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
L'acquisition d'images numériques est une pratique très répandue dans le
 milieu scientifique pour observer des échantillons et illustrer des résultats.
 Les récents développements des techniques d'imagerie permettent maintenant
 d'acquérir des images à des échelles très variées (microscopie à force
 atomique par exemple), d'explorer des structures tri-dimensionnelles (IRM,
 Tomographie, microscopie confocale...), et même d'obtenir des informations
 localisées sur la composition interne des échantillons via l'imagerie hyperspec
trale (Raman, micro-spectroscopie infrarouge...).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Quelques exemples d'image ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Une question qui se pose de plus en plus est d'utiliser ces images pour
 pouvoir mesurer de manière quantitative l'information observée, et ainsi
 utiliser l'image comme instrument de mesure.
 Dans un premier temps, il est possible de mesurer certains paramètres simples
 
\begin_inset Quotes cld
\end_inset

à la main
\begin_inset Quotes crd
\end_inset

, tels que le nombre de cellules, le diamètre apparent des particules...
 Cette approche est vite limitée pour plusieurs raisons : pour un grand
 nombre d'images le temps nécessaire devient vite prohibitif, la répétabilité
 des mesures n'est pas assurée, et la manipulation de certaines images (3D,
 multispectrales...) est complexe.
 De plus, on observe parfois des différences (textures, couleur...) que l'on
 ne sait pas toujours quantifier 
\begin_inset Quotes cld
\end_inset

à l'
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
oe 
\end_layout

\end_inset

il
\begin_inset Quotes crd
\end_inset

.
\end_layout

\begin_layout Standard
Le but de l'analyse d'images est de fournir des méthodes pour décrire de
 manière quantitative l'information fournie par les images numériques.
 Ses avantages sont nombreux :
\end_layout

\begin_layout Itemize
automatisation des traitements (gain de temps)
\end_layout

\begin_layout Itemize
répétabilité des résultats
\end_layout

\begin_layout Itemize
large choix d'outils
\end_layout

\begin_layout Standard
La mise en place d'une chaîne automatisée de traitements nécessite cependant
 de résoudre un certain nombre de problèmes.
 Par exemple, si on veut mesurer la taille et la forme de particules (cellules,
 tâches sur des feuilles...), il faut au préalable détecter ces particules,
 en tenant compte de la variabilité des conditions d'acquisition et des
 structures parasites.
 Une chaîne de traitement classique comprend donc les étapes suivantes :
\end_layout

\begin_layout Itemize

\series bold
pré-traitement
\series default
, pour corriger les défauts dus à l'acquisition et re-normaliser les images
\end_layout

\begin_layout Itemize

\series bold
amélioration
\series default
 de l'image, ou encore filtrage, pour mettre en valeur les informations
 utiles et réduire les informations parasites (le bruit)
\end_layout

\begin_layout Itemize

\series bold
segmentation
\series default
 de l'image, pour identifier les structures d'intérêt (des particules, des
 régions homogènes...)
\end_layout

\begin_layout Itemize

\series bold
analyse
\series default
 des particules ou des régions, pour quantifier la taille, la forme, ou
 la texture des objets d'intérêt
\end_layout

\begin_layout Standard
Le traitement d'images s'inscrit dans une chaîne de traitement plus large,
 qui comprend en amont la mise au point de l'acquisition (échantillonnage
 et préparation du matériel étudié, réglage des conditions d'acquisition,
 contrôle de l'éclairage...), et en aval une analyse statistique des résultats
 obtenus.
\end_layout

\begin_layout Standard
Ce document est organisé autour de trois parties.
 Une première partie présente la représentation informatisée des images,
 et les différentes modalités d'exploration des images parfois multidimensionnel
les.
 Une deuxième partie, plus technique, présente les outils classiques du
 traitement d'images.
 La troisième partie présente l'application de ces outils dans le cadre
 des différentes étapes de l'analyse d'images : le pré-traitement, la segmentati
on, et l'analyse des images.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
ajouter un mini biblio par chapitre ?
\end_layout

\end_inset


\end_layout

\begin_layout Part
Manipuler et explorer les images numériques
\end_layout

\begin_layout Chapter
Qu'est ce qu'une image numérique ?
\end_layout

\begin_layout Standard
Ce chapitre présente la nature des images telle qu'elles sont manipulées
 par les logiciels.
 Les questions de discrétisation de l'espace sont évoquées, puis quelques
 types d'images classiques sont présentés.
 Le chapitre se termine par une discussion sur les formats de fichiers adaptés
 pour le traitement des images.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Images matricielles et vectorielles
\end_layout

\begin_layout Standard
On rencontre couramment deux types d'images : les images matricielles (ou
 bitmap, ou plus rarement raster), et les images vectorielles.
\end_layout

\begin_layout Standard
Les 
\series bold
images matricielles
\series default
 consistent en un tableau à deux (ou plus) dimensions, dont chaque case
 contient la valeur d'un pixel (voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Image-Matricielle"

\end_inset

).
 Le terme pixel est la contraction de 
\begin_inset Quotes cld
\end_inset


\shape italic
\lang english
picture element
\shape default
\lang french

\begin_inset Quotes crd
\end_inset

.
 Les images fournies par les systèmes d'acquisition (microscope, appareil
 photo, scanner à plat...) sont de ce type.
 Elles sont stockées typiquement dans des fichiers aux formats .tif, .bmp,
 .png, .jpg...
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/avionRect.png
	height 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/avionCropX8Rect.png
	height 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/avionCrop2Values.png
	height 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Image-Matricielle"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Représentation d'une image matricielle
\end_layout

\end_inset

Une image matricielle, agrandissement d'une zone de l'image, et affichage
 des valeurs constituant la matrice image.
\begin_inset Note Note
status open

\begin_layout Plain Layout
Utiliser une image de microscopie
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Les 
\series bold
images vectorielles
\series default
 représentent une image sous la forme d'une série de primitives géométriques
 : segment, point, cercle, polygone...
 Leur gros avantage est que contrairement aux images matricielles, on peut
 agrandir une image vectorielle autant que l'on veut sans perte de qualité.
 Elles sont souvent utilisées pour sauvegarder le résultat de graphiques
 ou de dessins techniques.
 Elles sont sauvées dans des formats postscript (ps, eps), .fig, .svg...
\end_layout

\begin_layout Standard
Dans le cadre du traitement d'images, on travaille exclusivement sur des
 images matricielles.
 Les images vectorielles ne sont utilisées que pour sauvegarder des graphiques
 de résultats.
 Par contre, on ne se limite pas forcément aux images à deux dimensions.
 
\end_layout

\begin_layout Standard
De manière un peu plus formelle, on peut voir une 
\series bold
image comme une application
\series default
 (au sens mathématique du terme) qui à une position donnée 
\begin_inset Formula $p$
\end_inset

 fait correspondre une valeur 
\begin_inset Formula $v$
\end_inset

.
 Pour des images planes, la position est un point du plan, repéré par deux
 coordonnées 
\begin_inset Formula $x$
\end_inset

 et 
\begin_inset Formula $y$
\end_inset

.
 La valeur fournie est en général une intensité (lumineuse pour une caméra,
 de rayonnement pour un tomographe...), ou une information plus complexe (couleur,
 spectre...).
 La valeur d'un pixel peut être représentée par un vecteur de 
\begin_inset Formula $q$
\end_inset

 valeurs, avec 
\begin_inset Formula $q=1$
\end_inset

 pour une image d'intensité ou 
\begin_inset Formula $q=3$
\end_inset

 pour une image couleur.
 Une image idéalisée peut donc être vue comme une fonction de la forme :
\begin_inset Formula 
\begin{equation}
F:\left\{ \begin{array}{ccc}
\mathbb{R}^{n} & \rightarrow & \mathbb{R}^{q}\\
p & \rightarrow & v=F(p)
\end{array}\right.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
En pratique, une image matricielle est soumise à deux types de 
\series bold
perte d'information
\series default
 :
\end_layout

\begin_layout Itemize
une 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sub:Discretisation-Image]{{
\backslash
normalfont 
\backslash
bfseries discrétisation} de l'espace}
\end_layout

\end_inset

, qui ne mesure la valeur des pixels que pour un nombre fini de positions
\end_layout

\begin_layout Itemize
une 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sub:Types-Donnees]{{
\backslash
normalfont 
\backslash
bfseries quantification}}
\end_layout

\end_inset

 de la valeur des pixels en un nombre fini de valeurs, qui résulte de la
 conversion d'un signal analogique vers un signal numérique
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Discretisation-Image"

\end_inset

Discrétisation de l'espace image
\end_layout

\begin_layout Standard
Dans les images matricielles 2D, les valeurs sont définies uniquement pour
 chaque élément de la matrice image.
 De manière traditionelle, l'origine de l'image se situe en haut à gauche,
 en comptant les colonnes vers la droite et les lignes vers le bas, tous
 les deux en commençant à 
\begin_inset Formula $0$
\end_inset

.
 Les valeurs disponibles sont donc de la forme :
\begin_inset Formula 
\begin{equation}
F(x,y)\simeq I(u,v),u\in[0;M-1],v\in[0;N-1]
\end{equation}

\end_inset

où 
\begin_inset Formula $u$
\end_inset

 et 
\begin_inset Formula $v$
\end_inset

 sont des valeurs entières représentant les indices des colonnes et des
 lignes, et 
\begin_inset Formula $M$
\end_inset

 et 
\begin_inset Formula $N$
\end_inset

 représentent la largeur et la hauteur de l'image (voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Grille-Image"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/grilleImage.png
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Grille-Image"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Positions des pixels dans le repère image
\end_layout

\end_inset

Positions des pixels dans le repère image.
 Chaque pixel est repéré par l'indice de sa ligne (entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $N-1$
\end_inset

) et l'indice de sa colonne (entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $M-1$
\end_inset

)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La 
\series bold
résolution
\series default
 d'une image spécifie la distance, en unités métriques, entre deux pixels.
 Pour les images destinées à l'impression, elle est souvent exprimée en
 points par pouce (
\shape italic
\lang english
dots pet inch
\shape default
\lang french
, ou DPI).
 En général, les pixels sont carrés et la résolution est la même pour les
 directions horizontales et verticales.
\end_layout

\begin_layout Standard
Les informations que l'on cherche à extraire des images étant souvent des
 paramètres de tailles ou de distances entre objets, il est important de
 disposer de la résolution pour l'analyse.
 Certains appareils d'acquisition enregistrent la résolution dans les meta-donné
es au sein des fichiers images, ou dans une base de données propre.
 Pour la visualisation, des barres d'échelle sont parfois incrustées de
 manière automatique dans l'image, mais leur exploitation automatique n'est
 pas facile.
 Enfin, si aucune information de résolution n'est disponible (par exemple
 pour les caméras), il est nécessaire d'utiliser des mires ou des points
 de repère de dimension connue.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Types-Donnees"

\end_inset

Images en niveaux de gris
\end_layout

\begin_layout Standard
On peut classer les images en fonction de l'information contenue par chaque
 pixel.
\end_layout

\begin_layout Subsection
Quantification des niveaux de gris
\end_layout

\begin_layout Standard
Les images les plus simples contiennent une valeur d'intensité, codée sur
 un nombre fini de 
\series bold
niveaux de gris 
\series default
(on abrège parfois niveaux de gris en NDG).
 Le plus souvent, le nombre de niveaux de gris est codé sur 
\begin_inset Formula $256$
\end_inset

 valeurs, le noir correspondant à la valeur 
\begin_inset Formula $0$
\end_inset

 et le blanc à la valeur 
\begin_inset Formula $255$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/riceRect.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/riceCropX8Rect.png
	lyxscale 130
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/riceCropRectValues.png
	lyxscale 80
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Image-NDG"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Représentation d'une image en niveaux de gris
\end_layout

\end_inset

Une image en niveaux de gris, agrandissement d'une zone de l'image, et affichage
 des valeurs constituant la matrice image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le nombre 
\begin_inset Formula $256$
\end_inset

 vient de la représentation informatique des nombres entiers.
 L'unité de base manipulée par les ordinateurs est le 
\series bold
bit
\series default
, dont la valeur vaut soit 0 soit 1.
 Ces bits sont le plus souvent regroupés en 
\series bold
octets
\series default
, contenant 
\begin_inset Formula $8$
\end_inset

 bits.
 Le nombre d'octets différents est égal à 
\begin_inset Formula $2\times2\times\ldots\times2=2^{8}=256$
\end_inset

.
 En quantifiant les niveaux de gris sur un octet, on peut ainsi représenter
 
\begin_inset Formula $256$
\end_inset

 niveaux de gris différents.
\end_layout

\begin_layout Standard
Certains systèmes d'acquisition permettent d'acquérir des images avec une
 intensité codée sur 
\begin_inset Formula $12$
\end_inset

, 
\begin_inset Formula $14$
\end_inset

 ou 
\begin_inset Formula $16$
\end_inset

 bits, permettant de représenter jusqu'à 
\begin_inset Formula $4096$
\end_inset

, 
\begin_inset Formula $16384$
\end_inset

 ou 
\begin_inset Formula $65536$
\end_inset

 valeurs différentes.
 L'intérêt est de pouvoir détecter des variations d'intensité plus subtiles,
 mais leur visualisation nécessite des logiciels adaptés.
\end_layout

\begin_layout Subsection
Images binaires
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
introduire également images label, plus références aux chapitres spécifiques
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Les 
\series bold
images binaires
\series default
 sont des images en niveau de gris particulières, dont les valeurs valent
 soit 
\begin_inset Formula $0$
\end_inset

 (noir), soit 
\begin_inset Formula $1$
\end_inset

 (blanc).
 On cherche souvent à se ramener les images de départ à des images binaires,
 car il est très facile ensuite d'identifier les objets présents (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Image-Binaire"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/imgBinX16.tif
	height 5cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/imgBinValues.png
	lyxscale 50
	height 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Image-Binaire"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Représentation d'une image binaire
\end_layout

\end_inset

Une image binaire, avec le tableau de valeurs correspondant.
 L'image est représentée en négatif (les valeurs 1 en noir, les valeurs
 0 en blanc), afin de mieux visualiser les structures.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Images d'intensité
\end_layout

\begin_layout Standard
Il est possible de représenter la valeur des pixels avec des nombres à virgule
 flottante.
 Cela peut être utile si l'information stockée a une signification physique
 que l'on souhaite analyser (carte d'altitude, de profondeur, de densité...),
 ou pour stocker le résultat d'opérations arithmétiques sur plusieurs images.
 Par contre, les images en virgule flottante occupent plus de place en mémoire
 que les images en niveaux de gris.
 De plus, les valeurs minimales et maximales ne sont pas connues a priori,
 ce qui peut poser des problèmes d'affichage.
 On préfère donc en général stocker les résultats finaux en niveaux de gris.
\end_layout

\begin_layout Section
Images couleurs 
\end_layout

\begin_layout Standard
On rencontre plusieurs types d'images couleur, qui sont affichées de manière
 très similaire, mais dont la représentation interne est très différente.
\end_layout

\begin_layout Subsection
Images en vraies couleurs 
\end_layout

\begin_layout Standard
Les 
\series bold
images en vraies couleurs
\series default
 stockent pour chaque pixel 3 composantes : rouge, vert, bleu (ou RGB, pour
 
\shape italic
\lang english
Red-Green-Blue
\shape default
\lang french
), voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Composantes-Image-Couleur"

\end_inset

.
 Ces trois composantes permettent de représenter toutes les autres couleurs,
 y compris les nuances de gris.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/peppers-rgb.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Composantes-Image-Couleur"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Décomposition d'une image couleur
\end_layout

\end_inset

Décomposition d'une image couleur en ses trois composantes rouge, verte
 et bleue.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Si chaque composante est codée sur 
\begin_inset Formula $8$
\end_inset

 bits (soit 
\begin_inset Formula $256$
\end_inset

 valeurs possibles), on peut ainsi représenter jusqu'à 
\begin_inset Formula $256\times256\times256\simeq16$
\end_inset


\begin_inset space ~
\end_inset

millions de couleurs différentes.
 On parle aussi d'images couleurs 
\begin_inset Formula $24$
\end_inset

 bits.
 Pour le stockage, on rajoute parfois 
\begin_inset Formula $8$
\end_inset

 bits supplémentaires.
 Cet ajout permet de coder chaque pixel sur un entier de 
\begin_inset Formula $32$
\end_inset

 bits, qui est l'unité de calcul de base de nombreux ordinateurs, et d'extraire
 les composantes par des opérations opérant au niveau du bit.
 
\end_layout

\begin_layout Standard
Le traitement d'images sur des images couleurs est difficile.
 On utilise parfois des espaces couleurs différents, qui sont plus adaptés
 que les composantes rouge-vert-bleu.
 L'espace HSV décompose chaque pixel en trois composantes de teinte (
\shape italic
\lang english
hue
\shape default
\lang french
, qui représente la couleur principale), de saturation (dosage entre 
\begin_inset Quotes cld
\end_inset

coloré
\begin_inset Quotes crd
\end_inset

 et 
\begin_inset Quotes cld
\end_inset

gris
\begin_inset Quotes crd
\end_inset

), et de valeur (qui correspond à l'intensité globale du pixel).
\end_layout

\begin_layout Subsection
Images couleurs indexées
\end_layout

\begin_layout Standard
Les 
\series bold
images couleurs indexées
\series default
 stockent pour chaque pixel un numéro de couleur (son index), qui fait référence
 à une couleur stockée séparément dans une palette.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
un ptit schéma ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'intérêt de ces images est de réduire l'espace de stockage nécessaire,
 au prix d'une perte de qualité par rapport aux images en vraies couleurs.
 Par exemple, une image en 
\begin_inset Formula $256$
\end_inset

 couleurs indexées occupera sensiblement la même place qu'une image en 
\begin_inset Formula $256$
\end_inset

 niveaux de gris (la place occupée par la palette est négligeable par rapport
 à la taille de l'image).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
un exemple d'image couleur indexée ?
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Imagerie multi-canaux
\end_layout

\begin_layout Standard
En 
\series bold
microscopie multi-canaux
\series default
, on a l'habitude de représenter chaque canal avec une couleur différente.
 La représentation finale apparaît donc en couleur du fait de la combinaison
 des canaux associés aux couleurs rouge, verte et bleue (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Image-Multi-Canaux"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/neuron-red.tif
	lyxscale 200
	width 4cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/neuron-green.tif
	lyxscale 200
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/neuron-blue.tif
	lyxscale 200
	width 4cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/neuron-rgb.tif
	lyxscale 200
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Image-Multi-Canaux"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Représentation d'une image multi-canaux
\end_layout

\end_inset

Représentation d'une image multi-canaux en montrant soit chaque canal séparément
, soit en combinant les canaux pour former une image en fausses couleurs.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il faut bien garder à l'esprit que l'image ainsi obtenue est une image synthétiq
ue obtenue en combinant plusieurs images d'intensité, mais que les couleurs
 ainsi obtenues sont totalement arbitraires, et dépendent entre autres choses
 de l'ordre des composantes.
\end_layout

\begin_layout Subsection
Autres types de données
\end_layout

\begin_layout Standard
On distingue souvent les 
\series bold
images monomodales
\series default
 et les 
\series bold
images multimodales
\series default
.
 Les pixels d'une image monomodale sont représentés par une valeur unique.
 C'est le cas des images en niveau de gris.
 
\end_layout

\begin_layout Standard
Les images multimodales peuvent être décomposées en plusieurs composantes
 monomodales.
 Par exemple, une image couleur peut être décomposée en 3 composantes rouge,
 verte, et bleu, tandis qu'une image complexe peut être décomposé en 2 composant
es réelle et imaginaire.
 Chaque composante peut être étudiée ou travaillée séparément.
 On parle dans ce cas d'approche marginale.
 Il est souvent plus judicieux (et plus compliqué) de concevoir des traitements
 qui tiennent compte de l'ensemble des composantes.
\end_layout

\begin_layout Section
Formats de fichiers d'image
\end_layout

\begin_layout Standard
La sauvegarde des images sous forme de fichier nécessite de stocker non
 seulement la valeur de chaque pixel, mais aussi certaines méta-données
 telles que la taille de l'image, la manière dont sont encodées les valeurs,
 voire des informations de calibration spatiale.
\end_layout

\begin_layout Standard
Les images étant des données volumineuses, on peut être tenté de les compresser.
 Cependant, les algorithmes de compression efficaces pour les images courantes
 en milieu scientifique induisent une perte de données.
 Il vaut donc mieux stocker les images sous une forme non compressée, de
 préférence au format TIF.
\end_layout

\begin_layout Subsection
Structure des fichiers
\end_layout

\begin_layout Standard
Un fichier image est en général composé de deux parties : un en-tête, et
 des données.
 L'exception concerne les fichier raw, qui ne contiennent que les données
 brutes, et qui ne peuvent pas être lues sans connaître les conditions dans
 lesquelles a été acquise l'image.
 
\end_layout

\begin_layout Standard
L'
\series bold
en-tête
\series default
 contient la taille de l'image, le type de donnée (binaire, couleur, niveau
 de gris...), le nombre de bits utilisés pour le codage, l'ordre dans lequel
 sont stockés les valeurs, le type de compression utilisé...
 On peut parfois y trouver des informations utilisateurs (meta-données),
 telles que les données EXIF.
 Suivent ensuite les 
\series bold
données
\series default
, éventuellement compressées, qui ne peuvent être lues qu'une fois l'en-tête
 décodé.
\end_layout

\begin_layout Subsection
Compression des images
\end_layout

\begin_layout Standard
La 
\series bold
compression
\series default
 permet de transformer un ensemble de données de départ, correspondant aux
 valeurs des pixels, en un autre ensemble de données, de taille plus réduite,
 mais qui contient l'information de l'ensemble de départ.
 La 
\series bold
décompression
\series default
 est l'opération de reconstruction des valeurs de départ à partir des données
 compressées.
 On distingue deux modes de compression : avec perte (ou destructif) et
 sans perte (ou non destructif).
 
\end_layout

\begin_layout Standard
Dans un mode de 
\series bold
compression sans perte
\series default
, l'image obtenue après décompression correspond exactement à l'image initiale.
 Plusieurs algorithmes existent, tels que le RLE (
\shape italic
\lang english
Run-Length-Encoding
\shape default
\lang french
), qui détecte les plages de pixels de même valeur, ou le LZW, utilisé par
 les images GIF.
\end_layout

\begin_layout Standard
En pratique, ces types de compression sont plutôt efficaces pour des images
 avec beaucoup de 
\series bold
redondances
\series default
 (beaucoup de zones avec des couleurs uniforme).
 Les images scientifiques, au même titre que les photographies, contiennent
 très peu de redondances, et les algorithmes de compression sans perte sont
 donc assez peu efficaces.
\end_layout

\begin_layout Standard
Dans un mode de 
\series bold
compression avec perte
\series default
, on accepte que l'image obtenue après décompression présente quelques différenc
es avec l'image initiale.
 Les algorithmes utilisent pour cela une décomposition de l'image selon
 les composantes fréquentielles (compression JPEG) ou basée sur des ondelettes
 (JPEG2000), et ne conservent que les composantes principales de la décompositio
n.
 Il en résulte une détérioration de l'image reconstruite (voir la figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:defaut-jpeg"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/imageNum/piece.tif
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/piece-40.jpg
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/imageNum/piece-20.jpg
	width 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:defaut-jpeg"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Artefacts de compression JPG
\end_layout

\end_inset

Une image sauvée selon différents modes de compression : sans compression,
 jpg 40% et jpg 20%
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il va de soi que si l'on désire exploiter l'information stockée dans les
 images, il faut privilégier les modes de compression sans perte.
\end_layout

\begin_layout Subsection
Quelques formats
\end_layout

\begin_layout Standard
Il existent une grande quantité de formats de fichier d'image, dont quelques-uns
 sont particulièrement répandus :
\end_layout

\begin_layout Itemize
Tagged Image File Format (TIFF) c'est le format de prédilection pour sauvegarder
 des images scientifiques.
 Il permet de stocker des images en niveaux de gris, en couleur, binaire,
 compressée (sans perte) ou non, ainsi que des données utilisateurs (les
 tags).
 En général, les microscopes sauvent les conditions d'acquisition.
\end_layout

\begin_layout Itemize
Bitmap (BMP) ce format est très répandu sous Windows, moins sous Linux.
 Il permet de compresser sans pertes des images en couleurs ou en niveaux
 de gris.
\end_layout

\begin_layout Itemize
Portabe Network Graphics (PNG) il s'agit d'un format plus standard que le
 bitmap, qui autorise plus de possibilité de compressions, mais qui reste
 plus adapté pour les images de type dessin
\end_layout

\begin_layout Itemize
Jpeg (JPG) ce format est beaucoup utilisé pour stocker les photos, mais
 il compresse les images avec pertes.
 Il est à proscrire pour l'analyse d'images
\end_layout

\begin_layout Itemize
Portable bit map (PBM), portable gray map (PGM) et portable pixel map (PPM)
 : ces 3 trois formats stockent les valeurs des pixels dans un fichier texte.
 L'avantage est qu'un être humain peut lire directement le fichier, mais
 la taille de ces fichiers est beaucoup plus importante que les autres formats.
 
\end_layout

\begin_layout Standard
Attention enfin aux fausses images en niveaux de gris, qui stockent une
 valeur d'intensité identique pour les trois canaux rouge vert et bleu.
 L'image s'affiche en niveaux de gris, mais occupe trois à quatre fois plus
 de place qu'une vraie image en niveaux de gris...
\end_layout

\begin_layout Chapter
Explorer et visualiser des images
\end_layout

\begin_layout Standard
Bien que la plupart des images s'affichent correctement avec le premier
 logiciel venu, il peut arriver que le résultat ne soit pas celui attendu.
 De plus, pour certaines images particulières (images 3D, vidéos, images
 multispectrales...), ou bien si on veut examiner de très près les images (connaîtr
e la valeur en niveau de gris moyenne dans une région), les applications
 classiques de visualisation ne suffisent plus.
 Cette section a donc pour but de donner quelques clés pour éviter les mauvaises
 surprises.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Visualisation des niveaux de gris
\end_layout

\begin_layout Subsection
Images en niveaux de gris
\end_layout

\begin_layout Standard
À l'échelle 
\begin_inset Formula $1$
\end_inset

, les images en niveau de gris sont affichées en faisant correspondre chaque
 pixel de l'image à un pixel de l'écran.
 La convention générale est de représenter une faible valeur d'intensité
 par un pixel sombre, et une valeur élevée par un pixel clair (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Visualisation-Valeur-Intensité"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/viewGray8ImageValues.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Visualisation-Valeur-Intensité"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Visualiser les niveaux de gris d'une image
\end_layout

\end_inset

Visualisation d'une image en niveaux de gris, ainsi que des valeurs d'intensité
 correspondantes, sous Matlab.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
serait bien de trouver une image d'origine biologique.
 Tomate ?
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Normalisation des intensités
\end_layout

\begin_layout Standard
Les images en niveaux de gris sont la plupart du temps stockées sur 
\begin_inset Formula $256$
\end_inset

 niveaux de gris, allant de 
\begin_inset Formula $0$
\end_inset

 (représenté par du noir) à 
\begin_inset Formula $255$
\end_inset

 (représenté par du blanc).
 Certains logiciels, permettent d'inspecter directement la valeurs d'intensité
 des niveaux de gris, comme c'est le cas sur la figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Visualisation-Valeur-Intensité"

\end_inset

.
\end_layout

\begin_layout Standard
Dans le cas d'images en niveaux de gris codées sur plus de niveaux, les
 niveaux sont ramenés entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $255$
\end_inset

 pour l'affichage.
 Si l'affichage n'est pas celui attendu, il se peut que le problème vienne
 de cette normalisation.
 Une solution est de convertir soi-même les niveaux de gris à l'aide d'opération
s arithmétiques élémentaires (figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Conversion-NDG"

\end_inset

).
 Quelques méthodes de normalisation sont décrites dans la section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Modification-Histogramme"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/maizeGray16.tif
	width 5cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/maizeGray8.tif
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Conversion-NDG"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Image codée sur 4096 niveaux de gris
\end_layout

\end_inset

Une image codée sur 
\begin_inset Formula $2^{12}=4096$
\end_inset

 niveaux de gris, et sa représentation sous Matlab avant et après normalisation
 des valeurs entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $255$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Blanc sur noir ou noir sur blanc ?
\end_layout

\begin_layout Standard
Pour les images d'intensité codées en nombres à virgule flottante, le comporteme
nt par défaut des logiciels est de calculer les valeurs minimum et maximum,
 et de normaliser les valeurs par rapport à ces extrêmes.
 Parfois (par exemple sous Matlab), la normalisation se fait par défaut
 entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $1$
\end_inset

, ce qui peut ne pas correspondre au résultat attendu.
\end_layout

\begin_layout Standard
Pour les images binaires, on suit en général la même convention que pour
 les images en niveau de gris : la valeur 
\begin_inset Formula $0$
\end_inset

 est représenté par du noir, et la valeur 
\begin_inset Formula $1$
\end_inset

 par du blanc.
 Ce n'est pas toujours le cas : le logiciel ImageJ, par exemple, utilise
 par défaut la convention inverse.
\end_layout

\begin_layout Standard
Pour les documents imprimés, ou pour la présentation des résultats, on préfère
 souvent inverser la convention.
 Cela a plusieurs avantages : les structures fines sont plus visibles quand
 elles sont affichées en noir sur fond blanc, le résultat est (souvent)
 plus esthétique, et enfin cela évite de vider la cartouche d'encre de l'imprima
nte...
 Il convient donc d'être particulièrement attentif à la convention utilisée
 lorsque l'on travaille sur des images binaires ou d'intensité.
\end_layout

\begin_layout Subsection
Agrandissement de l'affichage
\end_layout

\begin_layout Standard
Quand on agrandit l'affichage de l'image, on
\series bold
 
\series default
doit
\series bold
 
\series default
voir apparaître les pixels individuels.
 Ce n'est pas le cas de tous les logiciels de visualisation.
 Par exemple, en utilisant la fonction d'aperçu fournie avec Windows, un
 lissage est appliqué automatiquement, ce qui peut tromper l'utilisateur
 sur la résolution effective de l'image (voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Agrandissement-Image"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
changer image démo pour avoir des cellules
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/avionCropZoomMS.png
	width 5cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/avionCropZoomIrfan.png
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Agrandissement-Image"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Agrandissement de l'affichage
\end_layout

\end_inset

La même portion d'image agrandie avec l'aperçu des photos de Windows (à
 gauche), et IrfanView (à droite).
 Malgré l'aspect lisse de l'image de gauche, elle n'est pas de meilleure
 qualité que l'image de droite.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Palettes de couleurs (tables de correspondance)
\end_layout

\begin_layout Standard
Les 
\series bold
palettes de couleurs
\series default
, ou 
\series bold
tables de correspondance
\series default
 (en anglais : 
\shape italic
\lang english
Look-Up Table
\shape default
\lang french
, abrégé en LUT) consistent à représenter chaque valeur de l'image non pas
 avec la valeur de gris correspondante, mais avec une couleur spécifique
 stockée dans une table.
 L'avantage est que certaines structures peuvent être mieux mises en évidence,
 du fait du nombre plus important de couleurs utilisé (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Representation-LUT"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/tomatoSlice.png
	lyxscale 50
	width 5cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/tomatoSliceJet.png
	lyxscale 50
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/tomatoSliceHsv.png
	lyxscale 50
	width 5cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/tomatoSliceHot.png
	lyxscale 50
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Representation-LUT"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Palettes de couleurs
\end_layout

\end_inset

Représentation d'une image en niveaux de gris en utilisant différentes palettes
 de couleur.
 De gauche à droite et de haut en bas : niveaux de gris naturels, palettes
 'jet', 'hsv' et 'hot' de Matlab.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il faut cependant garder à l'esprit que l'image d'origine n'est pas modifiée
 : c'est uniquement sa représentation qui change.
 
\end_layout

\begin_layout Standard
Quelques palettes régulièrement utilisées :
\end_layout

\begin_layout Description
hsv dégradé passant par le rouge, le vert, le bleu, puis de retour au rouge
\end_layout

\begin_layout Description
jet dégradé allant du bleu foncé (couleur froide) au rouge foncé (couleur
 chaude), en passant par le vert (couleur neutre)
\end_layout

\begin_layout Description
hot dégradé du noir au jaune
\end_layout

\begin_layout Description
inversion dégradé de niveaux de gris allant du blanc au noir, ce qui permet
 de représenter l'image 
\begin_inset Quotes cld
\end_inset

en négatif
\begin_inset Quotes crd
\end_inset


\end_layout

\begin_layout Description
bleu+gris+rouge dégradé de niveaux de gris, mais la valeur 
\begin_inset Formula $0$
\end_inset

 est affichée en bleu, et la valeur 
\begin_inset Formula $255$
\end_inset

 est affichée en rouge, afin de mettre en évidence les zones trop ou trop
 peu exposées
\end_layout

\begin_layout Section
Profils d'intensité
\end_layout

\begin_layout Standard
Un outil interactif très intuitif pour visualiser les variations d'intensité
 dans une image est le profil des intensités.
 Il faut tout d'abord choisi un outil de sélection linéaire (segment, droite
 polygonale...), et tracer la région d'intérêt désirée.
 Le profil d'intensité permet de visualiser les variations d'intensité le
 long de la sélection (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Profil-Intensite"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/a4b008_lineSelection.png
	lyxscale 50
	width 30text%

\end_inset


\begin_inset Graphics
	filename images/visu/a4b008_profile.png
	lyxscale 50
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/visu/demoRgbProfileMaize.png
	lyxscale 40
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Profil-Intensite"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Profil d'intensité
\end_layout

\end_inset

Profil d'intensité sur une image en niveaux de gris, et sur une image couleur.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Une petite précaution est à prendre pour l'interprétation des valeurs :
 le profil est généralement calculé en interpolant les valeurs.
 On peut donc avoir des valeurs flottantes à partir d'images en niveaux
 de gris codés sur des entiers, ce qui peut être trompeur.
\end_layout

\begin_layout Standard
Pour des images couleurs, le comportement par défaut de certains logiciels
 est souvent d'afficher le profil d'intensité après conversion des couleurs.
 Pour ImageJ, le plugin 
\begin_inset Quotes cld
\end_inset

RGB Profile Plot
\begin_inset Quotes crd
\end_inset

 permet de pallier ce manque (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Profil-Intensite"

\end_inset

).
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Histogramme"

\end_inset

Histogramme
\end_layout

\begin_layout Standard
L'histogramme d'une image est une application qui à chaque valeur de niveau
 de gris dans l'image associe le nombre de pixels ayant cette valeur.
 Pour une image en 
\begin_inset Formula $256$
\end_inset

 niveaux de gris, le résultat de l'histogramme sera une liste de 
\begin_inset Formula $256$
\end_inset

 valeurs.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/maizeSlice_crop.png
	height 6cm

\end_inset


\begin_inset Graphics
	filename images/visu/maizeSlice_crop-histo-white.png
	height 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Histogramme"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Histogramme des niveaux de gris
\end_layout

\end_inset

Exemple d'image en niveau de gris représentant des cellules végétales, et
 l'histogramme des niveaux de gris correspondant.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme"

\end_inset

 représente une image en niveaux de gris de coupe de tige de maïs (comprenant
 des cellules et des faisceaux de xylème et phloèmes), et l'histogramme
 qui lui correspond.
 Le pic le plus à gauche de l'histogramme correspond aux pixels du fond
 (de couleur noire).
 Les valeurs de pixels 200 à 250 correspondent aux structures claires, tandis
 que les valeurs centrales (autour de 50 à 100) représentent les parois
 des cellules.
\end_layout

\begin_layout Standard
L'histogramme est un outil rapide permettant de vérifier la qualité de l'image
 :
\end_layout

\begin_layout Itemize
image globalement surexposée (trop claire) ou sous-exposée (trop sombre)
\end_layout

\begin_layout Itemize
histogramme idéalement centré, et le plus étalé possible
\end_layout

\begin_layout Itemize
présence ou absence de zones ayant un niveau de gris homogène
\end_layout

\begin_layout Standard
Quelques statistiques de base permettent de synthétiser les informations
 sur l'image : valeur moyenne de l'histogramme, position du mode (la valeur
 maximale), écart-type...
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Exemple de stats sur histogramme ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
donner une image trop sombre et/ou trop peu contrastée
\end_layout

\end_inset


\end_layout

\begin_layout Section
Histogramme d'une image couleur
\end_layout

\begin_layout Standard
Du fait de la nature multi-canale des images couleur, la représentation
 sous forme d'histogramme est plus compliquée.
 Une solution simple pour explorer la distribution des couleurs est de représent
er l'histogramme des valeurs de chaque canal séparément (traitement marginal)
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme-Image-Couleur"

\end_inset

-B).
 L'inconvénient de ce type de représentation est que l'on perd l'information
 sur la corrélation des composantes.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/2434a_corr_r40.png
	lyxscale 50
	height 4.5cm

\end_inset


\begin_inset Graphics
	filename images/visu/coupeMaizeRGB_histoRGB.png
	lyxscale 70
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Histogramme-Image-Couleur"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Histogramme d'une image couleur
\end_layout

\end_inset

Exemple d'image couleur représentant une coupe de tige de maïs colorée au
 FASGA, et histogramme des valeurs de chaque canal.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Afin de représenter les dépendances entre deux composantes colorimétriques,
 une solution est de passer par un histogramme conjoint, qui représente
 le nombre ou la fréquence des pixels pour chaque couple de valeurs dans
 deux composantes.
 La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme-Image-Couleur-ND"

\end_inset

A représente ainsi l'histogramme conjoint des canaux rouge et bleu pour
 l'image représentée sur la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme-Image-Couleur"

\end_inset

-A.
 On distingue plusieurs grappes de pixels de couleur proches, qui seraient
 plus difficiles à détecter sur un histogramme simple :
\end_layout

\begin_layout Itemize
la partie centrale de l'histogramme (valeurs moyennes de rouge et de bleu)
 correspond aux pixels magenta sombre, situés principalement dans l'écorce,
\end_layout

\begin_layout Itemize
le coin supérieur gauche de l'histogramme (valeurs élevées à la fois de
 bleu et de rouge) correspond aux pixels magenta clair, prépondérants dans
 le parenchyme,
\end_layout

\begin_layout Itemize
la partie supérieure centrale de l'histogramme (valeurs élevées de bleu,
 moyennes de rouge) correspond aux pixels situés dans la zone bleue (en
 périphérie du parenchyme et autour des faisceaux).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/maizeSlice_histoRB_rgb.png
	lyxscale 70
	height 4cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/maize_fasga_colorInspector3D.png
	lyxscale 70
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Histogramme-Image-Couleur-ND"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Histogrammes 2D et 3D d'une image couleur
\end_layout

\end_inset

Représentations multidimensionnelles de la distribution des couleurs dans
 l'image 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme-Image-Couleur"

\end_inset

.
 A) histogramme conjoint des canaux rouge et bleu, B) représentation 3D
 de la distribution des couleurs dans l'espace RGB.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La démarche peut être poussée plus loin en calculant un histogramme 3D dans
 un espace colorimétrique donné, typiquement l'espace RGB (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Histogramme-Image-Couleur-ND"

\end_inset

).
 Avec une coloration appropriée, on retrouve intuitivement les colorations
 observables sur l'image d'origine.
 Par contre, l'exploitation de ce type de représentation nécessite d'utiliser
 des outils statistiques plus évolués (clustering, réduction de dimension...).
\end_layout

\begin_layout Section
Calibration spatiale
\end_layout

\begin_layout Standard
À partir du moment où l'on veut mesurer des paramètres morphologiques (longueur,
 distance, surface...) dans des images, il est nécessaire de connaître la résolutio
n de l'image.
 Heureusement, la plupart des logiciels de traitement permettent de calibrer
 les images en spécifiant leur résolution.
\end_layout

\begin_layout Standard
La méthode la plus simple est de fournir cette résolution manuellement,
 si elle est connue.
 L'autre solution est de choisir dans l'image un point de repère de longueur
 connue, de mesurer sa longueur en nombre de pixels, et d'effectuer la mise
 à l'échelle (figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Image-Calibree"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/viewColorImageCalib.png
	lyxscale 70
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Image-Calibree"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Calibration spatiale d'une image
\end_layout

\end_inset

Affichage d'une image après sa calibration sous ImageJ.
 La calibration s'est faite à l'aide de la barre d'échelle en bas à droite.
 La position du pixel est donnée en microns, et les valeurs de rouge, vert
 bleu correspondantes sont données dans la fenêtre principale.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Images 3D, 4D, 5D...
\end_layout

\begin_layout Standard
De plus en plus d'appareils d'acquisition produisent des images en 3 dimensions
 : IRM, tomographie, microscopie confocale...
 Les valeurs de l'image sont stockées dans des tableaux à 3 dimensions,
 et les éléments sont appelés des 
\emph on
\lang english
voxels
\emph default
\lang french
 (pour 
\emph on
\lang english
volume element
\emph default
\lang french
).
\end_layout

\begin_layout Standard
Si les images sont acquises à des temps différents, on obtient des films,
 où le temps joue le rôle d'une troisième ou quatrième dimension.
 Pour les images hyperspectrales, on peut encore rajouter une dimension
 supplémentaire.
 On arrive donc à des images allant jusqu'à 
\begin_inset Formula $5$
\end_inset

 dimensions, ce qui rend parfois leur exploration problématique.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
intégrer des reconstructions plan par plan dans la lignée Free-D.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Visualisation plan par plan
\end_layout

\begin_layout Standard
Le mode de visualisation le plus simple est de fixer les dimensions supérieures
 à la deuxième, et de représenter une 
\begin_inset Quotes cld
\end_inset

coupe 2D
\begin_inset Quotes crd
\end_inset

 de l'image.
 Le logiciel ImageJ permet ainsi de représenter une image 2D choisie dans
 une pile en faisant varier le canal ou la dimension en z (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Representation-tete-3D"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/visu/headSliceIJ.PNG
	height 4cm

\end_inset

 
\begin_inset Graphics
	filename images/visu/headSurfRec.PNG
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Representation-tete-3D"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Représentations par coupe et surfacique d'une image 3D
\end_layout

\end_inset

Représentation d'une image 3D en visualisant chaque coupe individuelle,
 ou en appliquant une reconstruction surfacique.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Représentation volumique
\end_layout

\begin_layout Standard
La reconstruction volumique montre l'image en perspective, en remplissant
 les voxels de l'image de manière plus ou moins dense en fonction de leur
 intensité.
 Il est ainsi possible de localiser les zones de l'image regroupant les
 voxels les plus lumineux.
\end_layout

\begin_layout Subsection
Reconstruction surfacique
\end_layout

\begin_layout Standard
Pour des images bien contrastées et relativement peu bruitées, il est possible
 de fixer une valeur seuil, et de représenter la surface équivalente qui
 entoure tous les pixels d'intensité inférieure (ou extérieure) à ce niveau
 (
\begin_inset Quotes cld
\end_inset


\emph on
isosurface
\emph default

\begin_inset Quotes crd
\end_inset

).
 On obtient une représentation sous forme de maillage surfacique, que l'on
 peut visualiser plus facilement en 3D, éventuellement en superposant un
 ensemble de coupes de l'image d'origine (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Representation-tete-3D"

\end_inset

).
 
\end_layout

\begin_layout Standard
L'algorithme le plus souvent employé pour cette tâche est celui des 
\begin_inset Quotes cld
\end_inset


\emph on
Marching Cubes
\emph default

\begin_inset Quotes crd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Lorensen1987"
literal "true"

\end_inset

, ou une de ses variantes comme les 
\emph on
marching tetrahedra
\emph default
.
\end_layout

\begin_layout Part
Les outils du traitement d'images
\end_layout

\begin_layout Standard
Le but du filtrage d'image est d'améliorer leur aspect, en rendant plus
 visibles les structures d'intérêt, tout en réduisant l'influence des informatio
ns parasites (bruit de l'image).
 On utilise pour cela différents 
\series bold
filtres
\series default
, qui vont transformer l'image de départ en une image filtrée, plus facile
 à analyser.
\end_layout

\begin_layout Standard
On peut classer les filtres en fonction de la quantité d'information nécessaire
 pour calculer la valeur d'un pixel de l'image résultat.
 Certains filtres appliquent simplement une fonction de conversion à la
 valeur de 
\series bold
chaque pixel
\series default
.
 C'est le cas des filtres qui modifient l'histogramme, ou des filtres de
 binarisation.
\end_layout

\begin_layout Standard
D'autres filtres opèrent sur un 
\series bold
voisinage local 
\series default
de chaque pixel.
 Pour chaque pixel, le résultat du filtre ne dépendra que des valeurs des
 pixels voisins.
 Par exemple, une opération courante consiste à remplacer la valeur de chaque
 pixel par la valeur moyenne de ses voisins, ce qui a pour effet de réduire
 le bruit dans l'image.
 Une autre possibilité consiste à calculer la différence entre les valeurs
 des pixels du centre et de la périphérie du voisinage.
 L'effet sera alors de mettre en évidence les contours dans l'image.
\end_layout

\begin_layout Standard
Le résultat du filtrage dépendra en grande partie de la taille du voisinage
 : plus le voisinage est grand, et plus le résultat sera différent de l'image
 de départ.
 Il est aussi possible d'utiliser des formes de voisinage différentes.
 Les plus classiques sont les voisinages carrés de taille 
\begin_inset Formula $3\times3$
\end_inset

, 
\begin_inset Formula $5\times5$
\end_inset

...
 On peut préférer des voisinages en forme de disque, qui traitent toutes
 les directions de manière identique, au contraire des formes carrées.
 À l'inverse, on peut utiliser des voisinages en forme de segment de droite,
 pour détecter ou supprimer des formes fines.
\end_layout

\begin_layout Standard
Enfin, d'autres filtres ont besoin de la 
\series bold
totalité de l'image
\series default
 pour calculer le résultat en un point.
 C'est le cas des filtres de reconstruction morphologique, de seuillage
 par hystérésis, ou de la ligne de partage des eaux.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Ajouter chapitres 
\end_layout

\begin_layout Itemize
le filtrage fréquentiel
\end_layout

\begin_layout Itemize
classification non supervisée et apprentissage automatique
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Le filtrage linéaire
\end_layout

\begin_layout Standard
Les 
\series bold
filtres linéaires
\series default
 sont une classe particulière de filtres basés sur une opération de 
\series bold
convolution
\series default
.
 Les filtres linéaires sont utilisés aussi bien pour lisser les images que
 pour détecter des structures particulières (bords, spots...).
 Les propriétés mathématiques de la convolution permettent des implémentations
 souvent rapides.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Principe des filtres linéaires
\end_layout

\begin_layout Standard
Dans le cas d'un 
\series bold
filtrage linéaire
\series default
 de l'image, les opérations impliquées ne sont que des additions (ou soustractio
ns) et multiplications (ou divisions) par des valeurs constantes.
 En pratique, cela consiste à réaliser une moyenne pondérée de la valeur
 des pixels du voisinage.
 Par exemple, une opération courante consiste à remplacer la valeur de chaque
 pixel par la valeur moyenne de ses voisins.
 La nouvelle valeur du pixel 
\begin_inset Formula $I(u,v)$
\end_inset

 est déterminée par l'équation : 
\begin_inset Formula 
\begin{eqnarray}
I'(u,v) & \leftarrow1/9[ & I(u-1,v-1)+I(u,v-1)+I(u+1,v-1)\nonumber \\
 &  & +I(u-1,v)+I(u,v)+I(u+1,y)\label{eq:Filtre-3x3-developpe}\\
 &  & +I(u-1,v+1)+I(u,v+1)+I(u+1,v+1)]\nonumber 
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
On peut classer les filtres linéaire en fonction de leur effet sur l'image
 de départ.
 Les 
\series bold
filtres moyenneurs
\series default
 réduisent le bruit tout en lissant les structures.
 Les 
\series bold
filtres dérivatifs
\series default
 permettent de mettre en évidence les bords des structures, et sont très
 utilisés pour détecter les contours.
 Les 
\series bold
filtres dérivatifs du second ordre
\series default
 sont une alternative aux filtres dérivatifs simples, et permettent aussi
 de mettre en évidence les contours.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Principe
\end_layout

\begin_layout Plain Layout
correlation
\end_layout

\begin_layout Plain Layout
masque = noyau de convolution
\end_layout

\begin_layout Plain Layout
cf bouquin ImageJ.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Filtres moyenneurs
\end_layout

\begin_layout Standard
Les 
\series bold
filtres moyenneurs
\series default
, comme leur nom l'indique, calculent la moyenne, éventuellement pondérée,
 des pixels situés dans le voisinage de chaque pixel.
 Cette famille de filtres permet de réduire le bruit dans l'image, ce qui
 rend les zones homogènes plus lisses.
 Par contre, les contours sont fortement dégradés, et les structures trop
 fines peuvent devenir moins visibles.
\end_layout

\begin_layout Subsubsection
Filtres plats
\end_layout

\begin_layout Standard
Les filtres qui calculent une moyenne directe des pixels sont appelés 
\series bold
filtres plats
\series default
 (
\shape italic
\lang english
flat smoothing
\shape default
\lang french
).
 Ils utilisent en général des voisinages carrés (
\begin_inset Formula $3\times3$
\end_inset

, 
\begin_inset Formula $5\times5$
\end_inset

...).
 Pour un filtre plat de taille 
\begin_inset Formula $3\times3$
\end_inset

, la matrice de voisinage correspondante est la suivante :
\begin_inset Formula 
\[
H=\left[\begin{array}{ccc}
\nicefrac{1}{9} & \nicefrac{1}{9} & \nicefrac{1}{9}\\
\nicefrac{1}{9} & \nicefrac{1}{9} & \nicefrac{1}{9}\\
\nicefrac{1}{9} & \nicefrac{1}{9} & \nicefrac{1}{9}
\end{array}\right]=\frac{1}{9}\left[\begin{array}{ccc}
1 & 1 & 1\\
1 & 1 & 1\\
1 & 1 & 1
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Pour des filtres plats de taille 
\begin_inset Formula $n\times n$
\end_inset

, la matrice est de la forme :
\begin_inset Formula 
\[
\frac{1}{n^{2}}\times\left(\begin{array}{ccc}
1 & \cdots & 1\\
\vdots & \ddots & \vdots\\
1 & \cdots & 1
\end{array}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
Le résultat d'un filtre plat avec trois tailles de filtre différentes est
 donné sur la figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Filtres-Plats"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/flatSmoothFilters.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Filtres-Plats"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Lissage par filtre plat
\end_layout

\end_inset

Influence de la taille du voisinage sur le résultat d'un filtre plat.
 En dessous, on montre les profils d'intensité des niveaux de gris le long
 d'une ligne horizontale passant au niveau de l'aile de l'avion.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Moyennes pondérées
\end_layout

\begin_layout Standard
On peut vouloir pondérer le poids associé à la valeur de chaque voisin.
 En particulier, on peut supposer que l'influence d'un voisin proche est
 plus importante que celle d'un voisin éloigné.
 On utilise donc aussi des filtres pondérés selon la distance au pixel central
 :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
H=\left[\begin{array}{ccc}
0.05 & 0.15 & 0.05\\
0.15 & 0.20 & 0.15\\
0.05 & 0.15 & 0.05
\end{array}\right]=\frac{1}{20}\left[\begin{array}{ccc}
1 & 3 & 1\\
3 & 4 & 3\\
1 & 3 & 1
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Les pondérations les plus classiques sont d'utiliser un noyau gaussien ou
 parabolique.
 Pour un noyau gaussien, les coefficients sont calculés à partir de la distance
 au pixel central du noyau du filtre :
\begin_inset Formula 
\[
G(u,v)=\frac{1}{2\pi\sigma^{2}}e^{-\frac{u^{2}+v^{2}}{2\sigma^{2}}}
\]

\end_inset


\end_layout

\begin_layout Standard
Un noyau discret 
\begin_inset Formula $5\times5$
\end_inset

 approchant un filtrage par un noyau gaussien avec 
\begin_inset Formula $\sigma=2$
\end_inset

 est le suivant :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
H=\frac{1}{101}\left[\begin{array}{ccccc}
1 & 3 & 4 & 3 & 1\\
3 & 5 & 7 & 5 & 3\\
4 & 7 & 9 & 7 & 4\\
3 & 5 & 7 & 5 & 3\\
1 & 3 & 4 & 3 & 1
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Subsection
Filtres dérivatifs
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
on peut voir une certaine gradation de la complexité :
\end_layout

\begin_layout Itemize
différence simple [+1 -1]
\end_layout

\begin_layout Itemize
moyenne des différences [+1 0 -1]
\end_layout

\begin_layout Itemize
avec lissage plat (prewitt)
\end_layout

\begin_layout Itemize
avec lissage pseudo-gaussien (sobel)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: reprendre un peu l'intro
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dans une image en niveaux de gris, les contours des structures d'intérêt
 peuvent être mis en évidence en utilisant des filtres linéaires qui calculent
 les variations de niveaux de gris.
 Pour cela on utilise des noyaux qui calculent la différence entre les niveaux
 de gris dans une direction, et les niveaux de gris dans la direction opposée.
 Les 
\series bold
filtres de Prewitt
\series default
, par exemple, sont de la forme :
\begin_inset Formula 
\begin{equation}
P_{0\text{°}}=\left[\begin{array}{ccc}
-1 & 0 & 1\\
-1 & 0 & 1\\
-1 & 0 & 1
\end{array}\right],\,P_{90\text{°}}=\left[\begin{array}{ccc}
-1 & -1 & -1\\
0 & 0 & 0\\
1 & 1 & 1
\end{array}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/refImages/plane.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/planePrewitt00.tif
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/planePrewitt90.tif
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Resultat-Prewitt"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Gradients horizontal et vertical par filtre de Prewitt
\end_layout

\end_inset

Une image en niveaux de gris, et le résultat d'un filtre de Prewitt dans
 les directions horizontale et verticale.
 Les images filtrées ont été renormalisées entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $255$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le résultat de leur application sur une image en niveaux de gris est donné
 figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Resultat-Prewitt"

\end_inset

.
 Un filtre assez similaire est le 
\series bold
filtre de Sobel
\series default
, qui donne un poids plus important aux pixels plus proches du pixel central
 :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
S_{0\text{°}}=\left[\begin{array}{ccc}
-1 & 0 & 1\\
-2 & 0 & 2\\
-1 & 0 & 1
\end{array}\right],\,S_{90\text{°}}=\left[\begin{array}{ccc}
-1 & -2 & -1\\
0 & 0 & 0\\
1 & 2 & 1
\end{array}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Il est aussi possible de considérer les 
\series bold
directions diagonales
\series default
, en orientant différemment les coefficients :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
P_{45\text{°}}=\left[\begin{array}{ccc}
-1 & 1 & 0\\
-1 & 0 & 1\\
0 & 1 & 1
\end{array}\right],\,P_{135\text{°}}=\left[\begin{array}{ccc}
0 & -1 & -1\\
1 & 0 & -1\\
1 & 1 & 0
\end{array}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
L'image finale des contours est obtenue en combinant les résultats des filtres
 Prewitt ou Sobel dans plusieurs directions.
 Une combinaison pratique est de calculer le module des directions orthogonales
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Resultat-Contours"

\end_inset

), pour obtenir une 
\series bold
image gradient 
\series default
:
\begin_inset Formula 
\[
I'=\sqrt{P_{0\text{°}}(I)^{2}+P_{90\text{°}}(I)^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/planePrewittStr.tif
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/planeSobelStr.tif
	width 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Resultat-Contours"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Détection des contours par Prewitt et Sobel
\end_layout

\end_inset

Résultat de la détection des contours en utilisant les fitres de Prewitt
 (à gauche) ou de Sobel (à droite), et en calculant le module sur les directions
 horizontale et verticale.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Filtre de Roberts : utilise [1 0;0 -1], et [0 1;-1 0]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Filtre laplacien (chapeau mexicain)
\end_layout

\begin_layout Section
Transformée de Fourier
\end_layout

\end_inset


\end_layout

\begin_layout Section
Autres filtres classiques
\end_layout

\begin_layout Subsection
Filtres d'ordre
\end_layout

\begin_layout Standard
Les 
\series bold
filtres d'ordre
\series default
 considèrent l'ensemble des pixels du voisinage, classés par ordre croissant
 d'intensité, et sélectionnent le 
\begin_inset Formula $i$
\end_inset

-ème pixel de la liste pour l'affecter au résultat.
 Les filtres les plus utilisés de cette famille sont les filtres min, max,
 et médian.
\end_layout

\begin_layout Standard
Le 
\series bold
filtre médian
\series default
, comme sont nom l'indique, sélectionne la valeur médiane des pixels du
 voisinage.
 Pour un voisinage carré 
\begin_inset Formula $5\times5$
\end_inset

, par exemple, les valeurs des 
\begin_inset Formula $25$
\end_inset

 voisins sont ordonnées par ordre croissant, et la 
\begin_inset Formula $13$
\end_inset

-ième valeur est gardée comme résultat.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/medianFilters.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Filtres-Medians"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Lissage par filtre gaussien
\end_layout

\end_inset

Influence de la taille du voisinage sur le résultat d'un filtre médian.
 En dessous, on montre les profils d'intensité des niveaux de gris le long
 d'une ligne horizontale passant au niveau de l'aile de l'avion.
 À comparer avec la figure équivalente pour les filtres moyenneurs (Figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Filtres-Plats"

\end_inset

).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'avantage du filtre médian est qu'il permet de réduire fortement le bruit
 dans l'image, et qu'il préserve beaucoup mieux les bords que les filtres
 moyenneurs.
\end_layout

\begin_layout Standard
Les 
\series bold
filtres minimum et maximum
\series default
 ordonnent l'ensemble des pixels du voisinage, et sélectionnent soit la
 plus petite ou la plus élevée.
 Cette famille de filtre permet de supprimer des petits détails très lumineux
 ou très sombres, mais affecte fortement la taille des objets.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/filtrage/minMaxFilters.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Filtres-Min-Max"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Filtres min et max
\end_layout

\end_inset

Influence de la taille du voisinage sur le résultat des filtres min et max.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le 
\series bold
filtre de dynamique locale
\series default
 (
\begin_inset Quotes cld
\end_inset


\shape italic
range filter
\shape default

\begin_inset Quotes crd
\end_inset

) permet de quantifier si un pixel est dans une zone homogène ou non.
 Il se calcule à partir de la différence entre les filtres minimum et maximum.
 Il donne des résultats souvent assez similaires à ceux du gradient.
 Un avantage est que les résultats peuvent être codés avec le même type
 de données que l'image d'origine, alors que le gradient nécessite en général
 de passer par des nombre à virgule flottante.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/filtrage/planeRangeFilt.png
	width 8cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Filtre-Dynamique"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Filtre de dynamique locale
\end_layout

\end_inset

Calcul du filtre de dynamique locale sur une image d'avion.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Filtre bilatéral
\end_layout

\begin_layout Plain Layout
pondération en fonction de la distance et de la différence d'intensité.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il existe de nombreux autres filtres de réduction du bruit dans les images
 numériques.
 Parmi les plus connus, on peut citer les filtres de Nagao, de Kuwahara,
 ou encore le filtre bilatéral.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Filtres directionnels
\end_layout

\begin_layout Plain Layout
avec ouverture et élement structurants linéaires d'orientations variées
\end_layout

\end_inset


\end_layout

\begin_layout Section
Traitement des images couleur 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
où mettre cette partie ? à intégrer à un chapitre 
\begin_inset Quotes cld
\end_inset

traitements
\begin_inset Quotes crd
\end_inset

, qui introduit les filtres et la segmentation ? où alors un chapitre particulie
r sur les images couleur ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le traitement des images couleurs pose parfois quelques difficultés, du
 fait que chaque pixel est représenté non pas par une valeur, mais par un
 ensemble de valeurs.
 Le même problème se rencontre pour le traitement des images multicanaux
 ou multispectrale.
\end_layout

\begin_layout Standard
Une solution radicale consiste à 
\series bold
convertir l'image en niveaux de gris
\series default
, et à ne travailler que sur l'image d'intensité.
 Cette approche présente l'inconvénient de perdre la richesse de l'information
 couleur, mais est parfois la plus rapide à mettre en 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
oe 
\end_layout

\end_inset

uvre.
\end_layout

\begin_layout Standard
Une approche plus satisfaisante est l'
\series bold
approche marginale
\series default
, qui consiste à séparer les différents canaux, et à travailler séparément
 sur chacun des canaux qui peuvent être vus comme des images en niveaux
 de gris.
 Il est parfois préférable de d'abord 
\series bold
changer l'espace de représentation des couleurs
\series default
 afin de mieux séparer les différentes informations.
 En particulier, les espaces HSV ou Lab se révèlent souvent très utiles.
 Les résultats des traitements sur les différents canaux peuvent ensuite
 être recombinés, pour former une nouvelle image couleur ou en niveaux de
 gris.
\end_layout

\begin_layout Standard
Le traitement des images couleur peut aussi se faire en tenant compte de
 la nature vectorielle de l'information fournie par chaque pixel.
 Cette 
\series bold
approche globale
\series default
 nécessite de développer des algorithmes spécifiques, et est donc moins
 souvent représentée dans la palette des outils disponibles.
\end_layout

\begin_layout Chapter
Morphologie Mathématique
\end_layout

\begin_layout Standard
La 
\series bold
morphologie mathématique
\series default
 est une classe d'opérateurs de traitement d'images qui a été développée
 à l'origine pour des images binaires, mais qui a depuis été étendue aux
 images en niveaux de gris 
\begin_inset CommandInset citation
LatexCommand citep
key "Serra1982,Soille2003"
literal "true"

\end_inset

.
 Les outils seront présentés ici sur des images binaires.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: arriver à intégrer plus d'exemples en NDG
\end_layout

\begin_layout Plain Layout
cd manuel de MorphoLibJ...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Principes
\end_layout

\begin_layout Standard
Les opérateurs morphologiques travaillent aussi sur le voisinage local de
 chaque pixel.
 La forme de ce voisinage est appelé 
\series bold
élément structurant
\series default
.
 Comme pour les filtres linéaires ou médian, on peut utiliser des éléments
 structurants de taille et de forme variées.
 Les éléments structurants couramment utilisés sont le disque (isotrope,
 mais qui nécessite souvent un temps de calcul plus long), et le carré,
 qui permet d'accélérer les calculs au prix de quelques artefacts.
\end_layout

\begin_layout Subsection
Érosion et dilatation
\end_layout

\begin_layout Standard
Une 
\series bold
dilatation morphologique
\series default
 consiste à déplacer l'élément structurant sur chaque pixel de l'image,
 et à regarder si l'élément structurant 
\begin_inset Quotes cld
\end_inset

touche
\begin_inset Quotes crd
\end_inset

 la structure d'intérêt.
 Plus formellement, on teste pour chaque position si l'intersection entre
 la structure et l'élément structurant après décalage est vide ou non.
 Le résultat est une structure plus grosse que la structure d'origine (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Erosion-Dilatation-Binaire"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 En fonction de la taille de l'élément structurant, certaines particules
 peuvent se trouver connectées, et certains trous disparaître.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphoMath/binarySet/binary-set.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ensemble binaire 
\begin_inset Formula $X$
\end_inset

 et élément structurant 
\begin_inset Formula $B$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphoMath/binarySet/binary-dilation-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Dilatation de 
\begin_inset Formula $X$
\end_inset

 par 
\begin_inset Formula $B$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphoMath/binarySet/binary-erosion-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Érosion de 
\begin_inset Formula $X$
\end_inset

 par 
\begin_inset Formula $B$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Erosion-Dilatation-Binaire"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Érosion et dilatation
\end_layout

\end_inset

Dilatation et érosion morphologiques d'un ensemble binaire, en utilisant
 un élement structurant 
\begin_inset Formula $B$
\end_inset

 en forme de disque.
 Dans les deux cas, le contour de la forme d'origine est affiché en surimpressio
n.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'
\series bold
érosion
\series default
 est l'opération inverse, qui est définie comme une dilatation du complémentaire
 de la structure.
 Elle consiste à chercher tous les pixels pour lesquels l'élément structurant
 centré sur ce pixel touche l'extérieur de la structure.
 Le résultat est une structure rognée (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Erosion-Dilatation-Binaire"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 On observe la disparition des particules plus petites que l'élément structurant
 utilisé, et la séparation éventuelle des grosses particules.
\end_layout

\begin_layout Standard
On peut remarquer qu'en niveaux de gris, l'érosion est équivalente à l'applicati
on d'un filtre minimum, tandis que la dilatation est équivalente à l'application
 d'un filtre maximum.
\end_layout

\begin_layout Subsection
Ouverture et fermeture
\end_layout

\begin_layout Standard
L'érosion et la dilatation ont l'inconvénient de modifier fortement la taille
 des structures dans l'image.
 Pour réduire cet effet, on les utilise souvent en combinaison.
 On définit ainsi la 
\series bold
fermeture morphologique
\series default
 comme une dilatation suivie d'une érosion, et l'
\series bold
ouverture morphologique
\series default
 comme une érosion suivie d'une dilatation (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ouverture-Fermeture-Binaire"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
L'ouverture et la fermeture morphologique ont une propriété 
\series bold
d'idempotence
\series default
 : le résultat ne change pas si on applique plusieurs fois l'opérateur,
 il suffit de l'appliquer une seule fois.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphoMath/binarySet/binary-opening-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Dilatation de 
\begin_inset Formula $X$
\end_inset

 par 
\begin_inset Formula $B$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphoMath/binarySet/binary-closing-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Érosion de 
\begin_inset Formula $X$
\end_inset

 par 
\begin_inset Formula $B$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Ouverture-Fermeture-Binaire"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Ouverture et fermeture morphologiques
\end_layout

\end_inset

Ouverture et fermeture morphologiques d'un ensemble binaire, en utilisant
 un élement structurant 
\begin_inset Formula $B$
\end_inset

 en forme de disque.
 Dans les deux cas, le contour de la forme d'origine est affiché en surimpressio
n.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'ouverture et la fermeture morphologique changent relativement peu la forme
 des grosses structures.
 Par contre, elle permettent de faire disparaitre facilement les petites
 particules isolées, ou les petits trous à l'intérieur des structures.
 On les utilise donc souvent pour nettoyer le résultat d'une binarisation.
 Le résultat d'une ouverture ou d'une fermeture peut aussi être comparé
 à l'image d'origine : c'est la base des opérations de top-hat et de bottom-hat.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Dicrétisation des éléments structurants
\end_layout

\begin_layout Plain Layout
Elements structurants en forme de carré, segments V et H, losange, octogone
\end_layout

\begin_layout Subsection
Morpho math en niveaux de gris
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Gradient et Laplacien morphologiques
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
White & black top-hats
\end_layout

\end_inset


\end_layout

\begin_layout Section
Exemple sur une image en niveaux de gris
\end_layout

\begin_layout Standard
La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Fermeture-Mais"

\end_inset

 présente l'application d'une fermeture morphologique sur une image de faisceau
 de maïs observé en microscopie confocale.
 La fermeture morphologique permet de faire disparaître les petites cellules,
 ce qui facilite la détection des cellules plus grosses sans changer leur
 forme de manière trop importante.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/refImages/maize-clsm.png
	lyxscale 50
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/filtrage/maizeDilate.png
	lyxscale 50
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/filtrage/maizeClose.png
	lyxscale 50
	width 30line%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Fermeture-Mais"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Dilatation et fermeture sur une image de maïs
\end_layout

\end_inset

Dilatation et fermeture morphologique sur une image de faisceau de maïs
 observée en microscopie confocale.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Filtres connexionnistes
\end_layout

\begin_layout Section
Reconstruction morphologique
\end_layout

\begin_layout Standard
La reconstruction morphologique est un des outils essentiels de la morphologie
 mathématique, car il est utilisé par de nombreux autres algorithmes, tels
 que le remplissage de trous, la suppression des objets touchant les bords
 de l'image, ou la détection minima et maxima étendus.
 L'idée est de propager le signal donné par une image de marqueurs initiaux,
 tout en tenant compte des limites imposées par une image de masque.
\end_layout

\begin_layout Subsection
Principe de la reconstruction morphologique
\end_layout

\begin_layout Standard
La 
\series bold
dilatation conditionnelle
\series default
 à un masque d'une image binaire consiste à lui appliquer une dilatation
 et à calculer l'intersection du résultat avec l'image de masque.
 Pour les images en niveaux de gris, on calcule le minimum des deux images.
 De manière duale, l'
\series bold
érosion conditionnelle
\series default
 à un masque d'une image en niveaux de gris consiste à appliquer une érosion,
 et à garder le maximum avec l'image de masque.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
exemple dilatation conditionnelle
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Une 
\series bold
reconstruction morphologique par dilatation
\series default
 est obtenue en itérant des dilatations conditionnellement à une image de
 masque, jusqu'à stabilité.
 De manière symétrique, une reconstruction morphologique par érosion est
 obtenue en itérant des érosions morphologiques conditionnellement à une
 image de masque.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphology/grains-markers-overlay.png
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/morphology/grains-binary-markers.png
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/morphology/grains-geodRec-byDilation.png
	width 30line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Reconstruction-Morphologique-Par-Dilatation"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Reconstruction morphologique en niveaux de gris
\end_layout

\end_inset

Reconstruction morphologique par dilatation sur une image en niveaux de
 gris.
 Des marqueurs sont sélectionnés manuellement, et une image binaire des
 marqueurs est générée.
 Cette image de marqueur est utilisée pour reconstruire les grains sélectionnés.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dans l'exemple ci-dessus, les marqueurs sont sélectionnés manuellement à
 l'intérieur de grains d'intérêt, et une image binaire des marqueurs est
 créée.
 L'image des marqueurs est alors dilatée conditionnellement à l'image initiale,
 et l'opération est répétée jusqu'à stabilité.
 Les marqueurs vont progressivement épouser la forme des grains qui les
 contiennent, mais les grains ne contenant pas de marqueurs ne seront pas
 présents dans l'image résultat.
\end_layout

\begin_layout Section
Minima et maxima
\end_layout

\begin_layout Subsection
Minima et maxima régionaux
\end_layout

\begin_layout Standard
On définit les 
\series bold
maxima régionaux
\series default
 comme des régions composées d'un ensemble connecté de pixels ayant tous
 la même valeur, et dont les voisins ont des valeurs strictement inférieure.
 Les minima régionaux sont définis de manière symétrique comme des régions
 dont les voisins ont tous des valeurs strictement supérieures à celle de
 la région.
\end_layout

\begin_layout Standard
On peut calculer l'image des maxima régionaux à partir de la différence
 entre l'image et le résultat de la reconstruction morphologique par dilatation
 de 
\begin_inset Formula $I-1$
\end_inset

 sous 
\begin_inset Formula $I$
\end_inset

 :
\begin_inset Formula 
\begin{eqnarray}
\mbox{RMAX}(I) & = & I-R^{\delta}(I-1,I)
\end{eqnarray}

\end_inset

ou, dans le cas où le type de données utilisé ne permet pas de représenter
 les valeurs négatives, par l'équation suivante :
\begin_inset Formula 
\begin{eqnarray}
\mbox{RMAX}(I) & = & (I+1)-R^{\delta}(I,I+1)\label{eq:Maxima-Regionaux}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Un exemple de détection des maxima régionaux sur une image en niveaux de
 gris est présenté sur la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Maxima-Regionaux-Et-Etendus"

\end_inset

.
\end_layout

\begin_layout Standard
De manière symétrique, les 
\series bold
minima régionaux
\series default
 sont définis à partir d'une reconstruction géodésique par érosion de 
\begin_inset Formula $I+1$
\end_inset

 au-dessus de 
\begin_inset Formula $I$
\end_inset

 : 
\begin_inset Formula 
\begin{eqnarray}
\mbox{RMIN}(I) & = & R^{\varepsilon}(I+1,I)-I\label{eq:Minima-Regionaux}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Subsection
Minima et maxima étendus
\end_layout

\begin_layout Standard
Les maxima étendus sont définis de manière assez similaire, mais de manière
 plus permissive.
 On se fixe une valeur de "dynamique", et on recherche les ensembles de
 pixels tels que la différence des intensités des pixels soit inférieure
 à la dynamique, et que tous les voisins aient une valeur inférieure au
 maximum de la région moins la dynamique.
 Cette nouvelle définition permet d'identifier des maxima plus étendus,
 et de limiter des effets du bruit dans l'image.
\end_layout

\begin_layout Standard
Les 
\series bold
minima et maxima étendus
\series default
 sont définis à partir du résultat d'une reconstruction morphologique :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\mbox{HMAX}(I,h) & = & R^{\delta}(I,I+h)\\
\mbox{EMAX}(I,h) & = & \mbox{RMAX}[\mbox{HMAX}(I,h)]\label{eq:Maxima-Etendus}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/morphology/grains-filtered.png
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/morphology/grains-rmax-ovr.png
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/morphology/grains-emax10-ovr.png
	width 30line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Maxima-Regionaux-Et-Etendus"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Détection des maxima régionaux et étendus
\end_layout

\end_inset

Détection des maxima régionaux et étendus sur une image en niveaux de gris.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dans l'exemple de la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Maxima-Regionaux-Et-Etendus"

\end_inset

, on s'aperçoit que la détection des maxima régionaux (image du centre)
 donne beaucoup de faux positifs (des régions détectées comme des maxima,
 mais qui n'en sont pas).
 De plus, la taille des maxima est relativement petite, et certains grains
 sont associés à plusieurs maxima.
 Au contraire, la détection des maxima étendus (image de droite), ici avec
 un seuil de 10, montre une meilleure correspondance entre les maxima détectés
 et les grains recherchés.
\end_layout

\begin_layout Standard
De manière symétrique, les minima régionaux sont définis à partir d'une
 reconstruction morphologique par érosion de 
\begin_inset Formula $I+1$
\end_inset

 au-dessus de 
\begin_inset Formula $I$
\end_inset

 : 
\begin_inset Formula 
\begin{eqnarray}
\mbox{HMIN}(I,h) & = & R^{\varepsilon}(I+h,I)\\
\mbox{EMIN}(I,h) & = & \mbox{RMIN}[\mbox{HMIN}(I,h)]\label{eq:Minima-Etendus}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Les minima étendus sont particulièrement efficace pour initialiser de manière
 automatique les marqueurs d'une ligne de partage des eaux.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
H-minima et H-maxima
\end_layout

\begin_layout Subsection
Imposition de minima
\end_layout

\begin_layout Plain Layout
permet d'initiliser une ligne de partage des eaux
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Traitement des images binaires
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Images binaires"

\end_inset


\end_layout

\begin_layout Standard
Ce chapitre regroupe plusieurs techniques spécifiques aux images binaires,
 couramment employées suite à des outils de segmentation, soit pour améliorer
 le résultat de la segmentation, ou pour simplifier la structures des objets
 visibles dans l'image.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
étiquetage des composantes connexes
\end_layout

\end_inset


\end_layout

\begin_layout Section
Carte des distances
\end_layout

\begin_layout Standard
La carte des distances (
\shape italic
\lang english
distance map
\shape default
\lang french
), ou fonction distance, est un outil très employé en traitement d'images.
 Elle consiste à calculer, pour chaque pixel, quelle est la distance la
 plus proche à une structure donnée.
 Par exemple, on peut calculer la distance au bord le plus proche pour les
 pixels à l'intérieur d'une particule (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Carte-des-distances"

\end_inset

).
\begin_inset Note Note
status open

\begin_layout Plain Layout
changer pour une image de feuille.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/circles-filled-inv.png
	width 6cm

\end_inset


\begin_inset Graphics
	filename images/binaires/circles-filled-dist-rgb.png
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Carte-des-distances"

\end_inset

Carte des distances d'une image binaire
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La carte des distances a de nombreuses applications :
\end_layout

\begin_layout Itemize
calcul du squelette d'une particule
\end_layout

\begin_layout Itemize
calcul de l'épaisseur moyenne le long du squelette
\end_layout

\begin_layout Itemize
calcul des zones d'influences de petits objets
\end_layout

\begin_layout Itemize
séparation de particules coalescentes
\end_layout

\begin_layout Itemize
...
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Distances de chanfrein
\end_layout

\begin_layout Plain Layout
Pour l'implémentation, on utilise une propagation de la fonction distance.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Nettoyage des résultats de segmentation
\end_layout

\begin_layout Standard
De nombreux outils sont disponibles pour nettoyer les résultats obtenus
 après segmentation.
\end_layout

\begin_layout Subsection
Suppression des petits objets
\end_layout

\begin_layout Standard
L'application d'un seuillage sur une image binaire produit souvent de nombreux
 faux positifs, correspondant à des variations d'intensité dans le fond
 de l'image qui sont détectés comme structure d'intérêt
\end_layout

\begin_layout Subsubsection
Filtrage morphologique
\end_layout

\begin_layout Standard
Une manière simple de supprimer ces artefacts est d'appliquer une ouverture
 morphologique binaire à l'image seuillée.
 Les particules dont la taille est inférieure à celle de l'élément structurant
 seront supprimées, tandis que les particules correspondant aux structures
 d'intérêt seront globalement préservées.
\end_layout

\begin_layout Standard
Si la forme des particules est très altérée par l'ouverture (ce qui peut
 arriver avec un élément structurant carré de grande taille), une possibilité
 est de rajouter une reconstruction géodésique, en utilisant comme marqueur
 l'image après ouverture, et comme masque l'image seuillée avant ouverture.
\end_layout

\begin_layout Subsubsection
Ouverture par attribut
\end_layout

\begin_layout Standard
Une alternative aux filtres morphologiques est d'utiliser une 
\begin_inset Quotes cld
\end_inset

ouverture par attribut
\begin_inset Quotes crd
\end_inset

.
 Le principe est de choisir un paramètre descriptif, et une plage de valeurs
 correspondant aux particules que l'on veut garder.
 Un choix typique est l'aire, et une valeur minimum correspondant aux particules
 
\begin_inset Quotes cld
\end_inset

suffisamment grandes
\begin_inset Quotes crd
\end_inset

 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ouverture-Par-Attribut"

\end_inset

).
 On calcule le ou les paramètres choisis pour chacune des particules identifiées
, et on ne garde que les particules pour lesquelles les paramètres sont
 dans la plage de validité.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
ajouter une figure pour comparer avec ouverture ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/riceBKRgb.tif
	width 5cm

\end_inset


\begin_inset Graphics
	filename images/binaires/riceBKAORgb.tif
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Ouverture-Par-Attribut"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Ouverture par attribut sur une image étiquetée.
\end_layout

\end_inset

Ouverture par attribut sur une image étiquetée.
 Seules les particules d'une taille supérieure à 15 pixels ont été gardées.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Cette méthode est implémentée dans ImageJ, dans les options de la commande
 
\begin_inset Quotes cld
\end_inset

Analyze Particles...
\begin_inset Quotes crd
\end_inset

, mais uniquement pour les paramètres de taille et de circularité.
 Sous Matlab, on peut utiliser la fonction 
\begin_inset Quotes cld
\end_inset

bwareaopen
\begin_inset Quotes crd
\end_inset

, ou bien passer par la fonction 
\begin_inset Quotes cld
\end_inset

regionprops
\begin_inset Quotes crd
\end_inset

 pour un traitement plus précis.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
ouverture par reconstruction
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Suppression des particules touchant les bords
\end_layout

\begin_layout Standard
En imagerie microscopique, il arrive couramment que les objets d'intérêt
 ne soient pas entièrement visibles dans l'image, et qu'une partie soit
 tronquée.
 Une pratique courante consiste donc à supprimer les objets qui touchent
 le bord de l'image (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Suppression-Des-Borde"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/riceBinRgb.tif
	width 5cm

\end_inset


\begin_inset Graphics
	filename images/binaires/riceBKRgb.tif
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Suppression-Des-Borde"

\end_inset

Suppression des particules touchant les bords.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
En pratique, la suppression s'opère à l'aide d'une reconstruction géodésique,
 avec comme marqueur l'intersection des objets avec le bord de l'image,
 et comme masque l'image binaire elle-même.
 On obtient comme résultat l'image des objets touchant le bord, qu'il suffit
 ensuite de soustraire de l'image d'origine.
 Cet outil est souvent implémenté comme une fonction à part entière dans
 les logiciels (fonction imclearborder sous Matlab, option de la fonction
 Analyze Particles sous ImageJ, outil 
\begin_inset Quotes cld
\end_inset

borderKill
\begin_inset Quotes crd
\end_inset

...).
\end_layout

\begin_layout Standard
Il faut toutefois prendre garde qu'en opérant ainsi, on introduit un biais
 dans les mesures qui seront faites par la suite, car les paramètres seront
 mesurés uniquement sur les particules entièrement visibles.
 Ainsi, plus une particule est petite, plus sa probabilité d'être observée
 sera importante, et les mesures globales seront biaisées en faveur des
 petites particules.
 Une possibilité d'obtenir des mesures plus proches de la réalité est d'applique
r la correction de Miles-Lantuéjoul, qui pondère les mesures sur les particules
 en fonction de leur probabilité d'échantillonnage.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
tite figure ?
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Remplissage des trous
\end_layout

\end_inset


\end_layout

\begin_layout Section
Codage des contours
\end_layout

\begin_layout Standard
On considère, pour chaque région ou particule de l'image binaire, la succession
 des pixels qui forment son contour.
 Au lieu de stocker l'ensemble des coordonnées de chaque pixel, on code
 la direction du pixel suivant, en utilisant une valeur entre 0 et 7.
 On obtient ainsi le 
\series bold
code de Freeman
\series default
.
\end_layout

\begin_layout Section
Séparation de particules se recouvrant
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Séparation-de-particules"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
pourrait trouver une image de démo plus adaptée
\end_layout

\end_inset


\end_layout

\begin_layout Standard
La ligne de partage des eaux est souvent utilisée pour séparer des particules
 qui se touchent après un seuillage (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-binaire"

\end_inset

-a).
 On commence par calculer la fonction distance par rapport au complémentaire
 des particules.
 Les maximas de l'image résultat sont situés vers le centre des particules.
 On inverse cette fonction distance, et on filtre un peu : les minimas sont
 alors les centres des particules (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-binaire"

\end_inset

-b).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/segment/circles-black.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/segment/circles-wat-ovr.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/segment/circles-sep.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Watershed-binaire"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Séparation de particules
\end_layout

\end_inset

Application de la ligne de partage des eaux pour séparer des particules
 connectées.
 (a) Image d'origine (b) fonction distance inversée et ligne de partage
 des eaux sur la fonction distance (c) séparation des particules.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On applique alors l'algorithme de ligne de partage des eaux.
 Les lignes de crêtes détectées sont les séparations entre les particules
 (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-binaire"

\end_inset

-c).
 En combinant avec l'image binaire d'origine, on arrive à séparer la plupart
 des particules (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-binaire"

\end_inset

-d).
\end_layout

\begin_layout Section
Squeletisation
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
objectif de cette section : présenter le principe de la squeletisation,
 et son utilisation
\end_layout

\end_inset


\end_layout

\begin_layout Standard
La squeletisation consiste à supprimer certains pixels pour ne garder que
 ceux situés le long des axes principaux.
 L'objectif est de garder la forme générale de la particule, afin de pouvoir
 en extraire des informations de nature topologique : points terminaux (extrémit
és du squelette), les points multiples (croisements), points formant les
 branches...
 Quelques exemples de squelettes sont montrés sur la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Squeletisation-abcd"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/abcd-bin.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binaires/skel-abcd-MatlabSkel-bin.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binaires/skel-abcd-MatlabSkel-ovr.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Squeletisation-abcd"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Squeletisation d'une image binaire.
\end_layout

\end_inset

Squeletisation d'une image binaire.
 Image d'origine, résultat de la squeletisation, et superposition du squelette
 sur l'image d'origine.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On définit le squelette dans un espace continu comme l'ensemble des points
 de la particule qui sont situés à égale distance d'au moins deux points
 de la frontière de l'ensemble d'intérêt 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 162"
key "Coster1989"
literal "true"

\end_inset

.
 Une définition plus formelle fait appel à l'ensemble des centres des boules
 de rayon maximal.
\end_layout

\begin_layout Standard
Les algorithmes de squeletisation utilisent la définition du squelette,
 adaptée à la nature discrète des images, pour cacluler une approximation
 du squelette euclidien.
 On obtient une image binaire dont les structures ont une épaisseur maximale
 d'un pixel, et qui reprennent la forme générale des particules.
\end_layout

\begin_layout Standard
Un des problèmes souvent rencontrés est que la squeletisation est une opération
 très sensible au bruit : une petite variation de forme peut engendrer des
 variations importantes du squelette.
 Cela se traduit notamment par la présence de nombreuses 
\begin_inset Quotes cld
\end_inset

barbules
\begin_inset Quotes crd
\end_inset

, qui relient l'axe du squelette aux petites aspérités du contour (sur les
 parties courbes du B, par exemple).
 Des outils dits 
\begin_inset Quotes cld
\end_inset

d'ébarbulage
\begin_inset Quotes crd
\end_inset

 (en anglais : 
\shape italic
\lang english
pruning
\shape default
\lang french
) sont parfois disponibles dans les logiciels.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/skel-abcd-MatlabSkel-ovr.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binaires/skel-abcd-MatlabThin-ovr.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binaires/skel-abcd-imagej-ovr.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Squeletisation-algos"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Différents algorithmes de squeletisation.
\end_layout

\end_inset

Différents algorithmes de squeletisation : résultats obtenus sous Matlab
 (par squeletisation et amincissement homotopiques), et sous ImageJ.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Un autre problème est qu'il existe de nombreux algorithmes de squeletisation
 chacun donnant des résultats différents (voir la figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Squeletisation-algos"

\end_inset

).
 Les algorithmes les plus courants se basent soit sur des cartes de distance,
 soit sur des amincissements homotopiques (amincissements successifs qui
 préservent la topologie des particules).
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
sous-sections possibles :
\end_layout

\begin_layout Itemize
algorithmes de squeletisation
\end_layout

\begin_layout Itemize
ébarbulage de squelette
\end_layout

\begin_layout Itemize
analyse de squelettes
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
à ajouter :
\end_layout

\begin_layout Itemize
exploitation de collections d'images
\end_layout

\begin_layout Itemize
fusion d'images (ou dans traitement ?)
\end_layout

\begin_layout Itemize
bases de données d'images
\end_layout

\end_inset


\end_layout

\begin_layout Part
Mise en oeuvre du traitement d'images
\end_layout

\begin_layout Chapter
Amélioration et restauration d'images
\end_layout

\begin_layout Standard
Les opérateurs décrits dans ce chapitre ont pour but d'améliorer l'aspect
 des images, en réduisant l'effet du bruit d'acquisition ou d'artefacts
 éventuels, ou de mettre en évidences certaines types de structures en se
 basant sur des a priori de forme.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Modification-Histogramme"

\end_inset

Modification d'histogramme
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
faire remonter cette section dans la partie plus générale 
\begin_inset Quotes cld
\end_inset

filtrage
\begin_inset Quotes crd
\end_inset

 ? ce sont des outils assez génériques...
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Lorsque les conditions d'acquisition d'une image en niveaux de gris sont
 mal maîtrisées, il peut arriver que l'image apparaisse trop sombre ou trop
 foncée.
 On peut améliorer l'affichage final, en modifiant l'histogramme de l'image.
 Cela consiste à calculer une table de correspondance des niveaux de gris.
\end_layout

\begin_layout Subsection
Tables de correspondances (LUT)
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
cette section est un peu perdue...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On peut modifier une image en calculant pour chaque pixel une nouvelle valeur
 
\begin_inset Formula $I'(u,v)$
\end_inset

 qui ne dépend que de la valeur de départ 
\begin_inset Formula $g=I(u,v)$
\end_inset

 du pixel
\begin_inset Formula 
\begin{eqnarray*}
g' & \leftarrow & f\left(g\right),\,\mbox{ou}\\
I'\left(u,v\right) & \leftarrow & f\left(I\left(u,v\right)\right)
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Le nombre de valeurs de départ étant fixe (
\begin_inset Formula $256$
\end_inset

 pour les images courantes), on peut précalculer les valeurs finales et
 stocker le résultat dans un tableau, appelé 
\series bold
table de correspondance,
\series default
 ou 
\shape italic
\lang english
look-up table
\shape default
\lang french
 (LUT).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/filtrage/liftingbodyInvDecHistoRes.png
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Tables-de-correspondance"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Tables de correspondances (LUT)
\end_layout

\end_inset

Application de deux tables de correspondances (LUT) sur l'image de départ
 : une inversion, et une re-quantification sur 8 niveaux de gris.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Tables-de-correspondance"

\end_inset

 montre deux LUT, et le résultat de leur application sur l'image de départ.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
LUT logarithmique, correction gamma
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Extension de dynamique
\end_layout

\begin_layout Standard
Cette méthode consiste à utiliser au mieux les niveaux de gris situés dans
 une plage de valeur donnée, et à les étaler de manière régulière pour couvrir
 toute la dynamique possible des niveaux de gris.
 
\end_layout

\begin_layout Standard
En pratique, la relation entre les niveaux de gris d'entrée et les niveaux
 de gris de sortie est une fonction affine, arrondie à des valeurs entières
 entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $255$
\end_inset

, que l'on peut calculer à partir des valeurs minimum et maximum des plages
 de niveaux de gris en entrée :
\begin_inset Formula 
\begin{equation}
f(g)=255\times\frac{g-g_{\mbox{min}}}{g_{\mbox{max}}-g_{\mbox{min}}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
La figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Expansion-Dynamique"

\end_inset

 montre l'image de départ après avoir transformé les niveaux de gris situés
 entre les valeurs 
\begin_inset Formula $95$
\end_inset

 et 
\begin_inset Formula $170$
\end_inset

 en des niveaux de gris situés entre 
\begin_inset Formula $0$
\end_inset

 et 
\begin_inset Formula $255$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
trouver des images plus en rapport avec la biologie
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/pretrait/liftingbodyAdj.png
	lyxscale 50
	height 5cm

\end_inset


\begin_inset Graphics
	filename images/pretrait/liftingBodyAdjHisto.png
	lyxscale 50
	height 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Expansion-Dynamique"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Extension de dynamique
\end_layout

\end_inset

Une image en niveau de gris après extension de sa dynamique, et son histogramme.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Égalisation d'histogramme
\end_layout

\begin_layout Standard
Cette opération a pour but de rendre un histogramme le plus plat possible.
 Elle calcule de manière automatique la fonction de transformation 
\begin_inset Formula $f(g)$
\end_inset

, en associant l'image à une modélisation probabiliste dont l'histogramme
 représente la densité de probabilité des niveaux de gris.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/pretrait/liftingbodyEqu.png
	lyxscale 50
	height 5cm

\end_inset


\begin_inset Graphics
	filename images/pretrait/liftingBodyEquHisto.png
	lyxscale 50
	height 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Egalisation-Histogramme"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Égalisation d'histogramme
\end_layout

\end_inset

Une image en niveau de gris après égalisation de son histogramme, et son
 histogramme.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Corrections géométriques
\end_layout

\begin_layout Standard
Les corrections géométriques ont pour but de compenser certaines déformations
 dues à l'optique des appareils (voir la figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Exemples-Distorsion-Optique"

\end_inset

), à des problèmes de perspective ou de rotation (pour des images obtenues
 avec un appareil photo classique ou une caméra), ou tout simplement pour
 créer une image mosaïque à partir de plusieurs images parcellaires.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
améliorer l'image...
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/pretrait/deformationCarre.png
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Exemples-Distorsion-Optique"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Distorsions géométriques
\end_layout

\end_inset

Exemples de distorsions géométriques pouvant survenir dans le cas d'un défaut
 d'optique.
 Le carré noir au centre représente l'image sans distorsion, le contour
 bleu extérieur représente une déformation en coussinet, et le contour rouge
 au centre représente une distorsion de type barillet.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
La correction se déroule en deux étapes :
\end_layout

\begin_layout Itemize
choix du modèle de déformation et calcul de ses paramètres, par rapport
 à l'aide de points de repères
\end_layout

\begin_layout Itemize
création de l'image résultat à partir de l'image de départ et des paramètres
 de la déformation
\end_layout

\begin_layout Standard
Le calcul de l'image finale nécessite de connaître la valeur d'intensité
 pour des positions qui ne sont pas situées sur la grille image.
 Cette intensité est calculée à partir des pixels voisins, en utilisant
 une fonction d'interpolation (linéaire, cubique...).
 Le résultat est ensuite converti en niveaux de gris.
\end_layout

\begin_layout Section
Soustraction du fond
\end_layout

\begin_layout Standard
Un artefact courant en microscopie optique est d'avoir le centre de l'image
 beaucoup plus lumineux que les coins.
 Les mesures d'intensité dépendent donc fortement de la position dans l'image,
 et il peut être nécessaire de corriger ce biais.
\end_layout

\begin_layout Standard
Les méthodes de correction classiques consistent à combiner une image de
 fond avec l'image observée.
 L'image de fond peut être une image de calibration acquise au préalable,
 avant d'observer l'échantillon.
 Si l'image de calibration est obtenue en observant une lame vide, les différenc
es d'intensité observées sont alors dues uniquement aux différences d'illuminati
on.
\end_layout

\begin_layout Standard
Si une image de calibration n'est pas disponible, il existe plusieurs algorithme
s permettant d'estimer une image de fond à partir d'une image expérimentale.
 On fait en général l'hypothèse que la taille des structures observées est
 petite devant l'étendue des variations d'intensité du fond.
 Les algorithmes populaires de cette famille sont le 
\begin_inset Quotes cld
\end_inset

rolling ball
\begin_inset Quotes crd
\end_inset

, et le chapeau haut-de-forme (ou tophat).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/pretrait/subtract-background-example.jpg
	width 12cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Correction-Du-Fond"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Correction du fond avec rolling-ball
\end_layout

\end_inset

Exemple de correction d'intensité du fond en utilisant l'outil 
\begin_inset Quotes cld
\end_inset

Rolling Ball
\begin_inset Quotes crd
\end_inset

 sous ImageJ
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Le 
\series bold
rolling ball
\series default
 considère une boule qui se promène sous la surface formée par les niveaux
 de gris.
 On suppose que le fond est sombre et les structures blanches.
 Dans les zones homogènes, le haut de la boule correspond au niveau de gris
 local, et donc au fond.
 Dans les zones avec des pics, la boule 
\begin_inset Quotes cld
\end_inset

bute
\begin_inset Quotes crd
\end_inset

 sur le niveau le plus sombre trouvé dans le voisinage, qui est assimilé
 au fond.
 En calculant l'altitude du haut de la boule pour chaque pixel de l'image,
 on en déduit une image approximative du fond, que l'on peut ensuite soustraire
 de l'image observée.
\end_layout

\begin_layout Standard
Sous ImageJ, cette opération est disponible via le menu Process\SpecialChar menuseparator
Subtract
 Background.
 On peut régler le rayon de la boule, et spécifier la couleur du fond.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Fitres top-hat et bottom-hat
\end_layout

\begin_layout Plain Layout
Exemple classique : suppression du fond sur une image de grain de riz sous
 Matlab
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Si la taille des structures observées est grande par rapport à la portée
 des variations, les approches de type rolling-ball ou top-hat vont introduire
 plus d'artefacts qu'elles n'en corrigent.
 Si les variations sont assez régulières, comme c'est souvent le cas pour
 les halos d'illumination, on peut modéliser ces variations sur l'ensemble
 de l'image, de manière à inférer la correction à apporter à l'intérieur
 des structures (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Correction-Fond-Modelise"

\end_inset

).
 La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Correction-Fond-Modelise"

\end_inset

 montre un exemple de calcul d'une image de fond en utilisant l'information
 de la périphérie de l'image, et en ajustant une surface polynomiale.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/pretrait/6641c.jpg
	lyxscale 70
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/pretrait/6641c_bg.png
	lyxscale 70
	width 30line%

\end_inset

 
\begin_inset Graphics
	filename images/pretrait/6641c_corr.png
	lyxscale 70
	width 30line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Correction-Fond-Modelise"

\end_inset


\begin_inset Argument 1
status collapsed

\begin_layout Plain Layout
Correction de fond par modélisation polynomiale
\end_layout

\end_inset

Correction de fond par modélisation polynomiale des variations d'intensité.
 (a) Image originale.
 (b) Modélisation des variations d'intensité dans l'image.
 (c) Image corrigée.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Images mosaïques
\end_layout

\begin_layout Section
Imagerie confocale
\end_layout

\begin_layout Subsection
Déconvolution
\end_layout

\begin_layout Subsection
Décroissance de l'intensité
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Réduction du bruit
\end_layout

\begin_layout Subsection
Qu'est ce que le bruit ?
\end_layout

\begin_layout Plain Layout
Introduire modèle signal = info + bruit, avec un exemple image
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Segmentation
\end_layout

\begin_layout Standard
On appelle 
\series bold
segmentation d'une image
\series default
 l'opération consistant à identifier les structures d'intérêt dans une image.
 On distingue deux types d'approches pour la segmentation : contour ou région.
 
\end_layout

\begin_layout Standard
Dans l'
\series bold
approche contour
\series default
, on cherche à isoler le ou les contours des objets d'intérêt.
 Le résultat se présente en général sous la forme d'un ensemble de chaînes
 de pixels, et des traitements additionnels sont souvent nécessaires pour
 associer les contours aux objets d'intérêt.
\end_layout

\begin_layout Standard
L'autre approche cherche à 
\series bold
identifier des régions
\series default
 de pixels homogènes au sein de l'image.
 Le critère d'homogénéité peut être l'intensité, la couleur, ou même la
 texture locale.
 Le résultat se présente soit sous la forme d'une image binaire, soit d'une
 image étiquetée, chaque étiquette ou label correspondant à une région.
 Les méthodes de seuillage et la ligne de partage des eaux sont les représentant
es emblématiques de cette approche.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Seuillage
\end_layout

\begin_layout Standard
Le 
\series bold
seuillage
\series default
 (en anglais 
\emph on
threshold
\emph default
) est sûrement la méthode de segmentation la plus simple.
 Elle consiste à tester pour chaque pixel de l'image si sa valeur est supérieure
 ou inférieure à un certain seuil, et produit une image binaire regroupant
 les résultats.
 Il est aussi possible d'utiliser plusieurs seuils, voire de sélectionner
 les pixels appartenant à une plage spécifique de niveaux de gris.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/segment/AupbSn-segOtsu-ovr.png
	lyxscale 50
	height 4cm

\end_inset

 
\begin_inset Graphics
	filename images/segment/AupbSn-segOtsu-histo.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Segmentation-Niveaux-Gris"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Segmentation par la méthode d'Otsu
\end_layout

\end_inset

Segmentation d'une image en niveaux de gris par la méthode d'Otsu sous ImageJ.
 A gauche, le résultat de la segmentation est affiché en surimpression.
 A droite, l'histogramme de l'image est affiché, avec la plage de niveaux
 de gris sélectionnée.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Détection automatique du seuil
\end_layout

\begin_layout Standard
Il existe plusieurs méthodes pour 
\series bold
détecter de manière automatique la valeur du seuil
\series default
 à appliquer.
 L'une des plus répandue est la méthode d'Otsu.
 Elle consiste à faire l'hypothèse que l'image contient deux classes, décrites
 chacune par une partie de l'histogramme de l'image.
 La qualité du seuillage est quantifiée en mesurant la variance des niveaux
 de gris de chaque classe.
 On cherche ensuite la valeur de seuil qui minimise les variances des deux
 classes, et on utilise cette valeur pour binariser l'image (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Segmentation-Niveaux-Gris"

\end_inset

).
\begin_inset Note Note
status open

\begin_layout Plain Layout
Détailler quelques méthodes: Otsu, max entropy...
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Seuillage à hystéresis
\end_layout

\begin_layout Standard
Le 
\series bold
seuillage à hystéresis
\series default
 est une méthode un peu plus perfectionnée, qui permet d'améliorer la détection
 des contours des zones contrastées, tout en évitant de détecter des zones
 du fond.
\end_layout

\begin_layout Standard
Le principe est d'utiliser deux seuils : un seuil 
\begin_inset Quotes cld
\end_inset

haut
\begin_inset Quotes crd
\end_inset

 et un seuil 
\begin_inset Quotes cld
\end_inset

bas
\begin_inset Quotes crd
\end_inset

.
 On sélectionne d’abord l'ensemble des pixels au dessus du seuil haut, puis
 l'ensemble des pixels au-dessus du seuil bas.
 On ne garde ensuite que les composantes connexes du seuil bas qui contiennent
 au moins un pixel au dessus du seuil haut.
\end_layout

\begin_layout Standard
En pratique, cette détection peut se faire soit par reconstruction géodésique,
 soit par étiquetage des composantes connexes de l'image des seuils bas
 et détection des étiquettes présentes dans l'image des seuils hauts.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
trouver exemple...
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Seuillage d'image couleurs 
\end_layout

\begin_layout Standard
Dans le cas d'images couleurs, chaque pixel est défini par un triplet (R,
 G, B) de valeurs, et on ne peut plus se baser sur un seuil simple.
 Une première possibilité pour segmenter une image couleur est de la 
\series bold
convertir en niveaux de gris
\series default
, et de travailler sur l'image d'intensité.
 L'inconvénient est que l'on perd de l'information, et que certaines couleurs
 différentes présentent un niveau de gris après conversion très proche.
 
\end_layout

\begin_layout Standard
Pour tirer parti de l'ensemble des canaux, une solution est de 
\series bold
segmenter chaque canal
\series default
 séparément, et de combiner les résultats des différents seuillages.
 On remarque cependant que les informations portées par les différents canaux
 sont souvent fortement corrélées, et qu'il est plus judicieux de travailler
 sur des images dans un 
\series bold
espace de couleur transformé
\series default
.
 L'espace HSV, par exemple, permet de séparer les notions de teinte, de
 saturation, et d'intensité, ce qui simplifie la recherche des seuils.
 Sous ImageJ, le plugin 
\begin_inset Quotes cld
\end_inset

Color Threshold
\begin_inset Quotes crd
\end_inset

 se révèle très pratique pour la segmentation d'images couleur.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/segment/maize-small-OpSq2.png
	lyxscale 50
	width 38text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/maize-small-OpSq2-ColorThresholdResult.png
	lyxscale 50
	width 38text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/maize-small-OpSq2-ColorThresholdDialog.png
	lyxscale 50
	width 20text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Segmentation-Couleur"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Segmentation d'image couleur par seuillage HSV
\end_layout

\end_inset

Segmentation d'une image couleur par seuillage des composantes de l'image
 après conversion dans l'espace HSV.
 Le canal de teinte permet de sélectionner les pixels de couleur bleue,
 et le canal d'intensité permet d'éviter la sursegmentation.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Chaque pixel couleur pouvant être vu comme un point dans un espace tridimensionn
el, il est aussi envisageable d'utiliser des 
\series bold
méthodes de classification
\series default
, supervisées ou non supervisées.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/segment/maize-small-OpSq2-Markers.png
	lyxscale 50
	width 45text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/maize-small-OpSq2-KMeans.png
	lyxscale 50
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Segmentation-Couleur-KMeans"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Segmentation d'image couleur par k-means
\end_layout

\end_inset

Segmentation d'une image couleur par la méthode des k-means : sélection
 des marqueurs pour les différentes classes, et résultat de la classification
 appliquée à l'ensemble de l'image.
\end_layout

\end_inset


\end_layout

\end_inset

Pour une classification non supervisée (
\emph on
clustering
\emph default
), le principe est d'identifier les pixels formant des groupes homogènes.
 La figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Segmentation-Couleur-KMeans"

\end_inset

 présente le cas d'une segmentation par les k-means appliquée à une image
 de coupe de tige maïs colorée au Fasga, et préalablement filtrée.
 Dans le cas d'une classification supervisée, les groupes seront définis
 à partir d'un ensemble de pixels d'apprentissage, utilisés pour déterminer
 les caractéristiques colorimétriques des différentes classes.
 L'avantage de ces méthodes est que les frontières entre classes peuvent
 être beaucoup plus libres que dans le cas d'un simple seuillage.
\end_layout

\begin_layout Section
Classification de pixels 
\end_layout

\begin_layout Standard
Les méthodes de classification, utiles pour la segmentation d'images couleur,
 peuvent aussi s'employer pour segmenter des images complexes en niveaux
 de gris.
 Pour discriminer efficacement les différentes classes de pixel, on cherche
 à décrire chaque pixel par un ensemble de caractéristiques.
 En appliquant une large variété de filtres de différente nature à l'image
 d'origine, on obtient pour chaque pixel autant de valeurs que le nombre
 de filtres appliqués.
 En choisissant des régions représentatives de chaque classe ou catégorie
 dans l'image, on peut initialiser un classifieur, qui va calculer les caractéri
stiques de chaque classe.
 En appliquant le résultat sur l'image d'origine, et si la famille de filtres
 a été correctement choisie, il est possible d'obtenir une segmentation
 d'image qu'il aurait été difficile d'obtenir autrement.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
image exemple
\end_layout

\begin_layout Itemize
cf Ignacio
\end_layout

\begin_layout Itemize
ou sinon Ilastix
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Détection de contours (
\shape italic
edge detection
\shape default
)
\end_layout

\begin_layout Subsection
Laplacien
\end_layout

\begin_layout Subsection
Gradient et Laplacien Morphologiques
\end_layout

\begin_layout Subsection
Filtre de Canny
\end_layout

\begin_layout Plain Layout
norme du gradient, puis seuillage par hysteresis
\end_layout

\end_inset


\end_layout

\begin_layout Section
Segmentation de régions par ligne de partage des eaux
\end_layout

\begin_layout Standard
La 
\series bold
ligne de partage des eaux
\series default
 est un outil de segmentation issu de la morphologie mathématique, qui trouve
 de nombreuses applications aussi bien en segmentation que comme outil de
 post-traitement.
 Une application est la segmentation de cellules séparées par leurs parois.
 En appliquant la ligne de partage des eaux sur une image gradient, on peut
 détecter les contours des objets.
 On l'utilise ainsi couramment pour séparer des particules binarisées qui
 se touchent (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Séparation-de-particules"

\end_inset

).
\end_layout

\begin_layout Subsection
Principe
\end_layout

\begin_layout Standard
L'algorithme s'applique à des images en niveaux de gris.
 L'image est assimilée à un paysage dont l'altitude de chaque point est
 donnée par l'intensité du pixel correspondant.
 Les pixels de forte intensité (blancs) correspondent à des sommets, tandis
 que les pixels de faible intensité (noir) correspondent à des fonds de
 vallées.
 
\end_layout

\begin_layout Standard
Le principe de l'algorithme est de partitionner l'image selon une approche
 topographique : on recherche les bassins versants, séparés par des lignes
 de crêtes.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Ajouter schéma de principe sur signal 1D
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
plusieurs algos :
\end_layout

\begin_layout Itemize
Vincent, basé sur des croissances de régions, initialisées aux minima locaux
 de l'image (-> préciser comment filtrer l'image de départ)
\end_layout

\begin_layout Itemize
méthode des bassins versants, implémentée dans ITK, sans ligne de séparation
\end_layout

\begin_layout Itemize
passer par des amincissements homotopiques
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Application sur une image de tissu végétal
\end_layout

\begin_layout Standard
La ligne de partage des eaux est particulièrement bien adaptée pour la segmentat
ion d'images de tissus végétaux, dans lesquelles les parois des cellules
 sont bien contrastées par rapport au fond.
 L'utilisation d'un seuillage n'est pas toujours le plus efficace : les
 variations d'intensité du fond rendent difficile l'identification du seuil,
 et le résultat de la segmentation laisse beaucoup de bruit à l'intérieur
 des cellules sous la forme de pixels isolés (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-cellules"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/refImages/maize-clsm.png
	lyxscale 60
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/maize-clsm-threshold50.tif
	lyxscale 60
	width 4.5cm

\end_inset

 
\begin_inset Graphics
	filename images/segment/maize-clsm-watDyn10.tif
	lyxscale 60
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Watershed-cellules"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Segmentation de cellules par ligne de partage des eaux
\end_layout

\end_inset

Une image de cellules végétales (à gauche), et le résultat de la segmentation
 par deux méthodes : seuillage (au centre), et ligne de partage des eaux
 (à droite).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'application de la ligne de partage des eaux permet de segmenter efficacement
 les cellules dans l'image.
 Les fonds des cellules représentent les bassins versants, tandis que les
 parois sont les lignes de crête de l'image.
 Le résultat est indépendant des variations d'intensité globales dans l'image,
 et l'image binaire résultante produit des structures dont l'épaisseur est
 régulière (1 ou 2 pixels).
 Le résultat est soit l'image binaire de la ligne de partage des eaux (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-cellules"

\end_inset

-b), soit l'image étiquetée corresondant aux différentes régions, ici les
 cellules.
\end_layout

\begin_layout Standard
Il y a cependant quelques précautions à prendre avant d'appliquer la ligne
 de partage des eaux :
\end_layout

\begin_layout Itemize
Les images gagnent à être 
\series bold
filtrées
\series default
 au préalable, sous peine de voir apparaître de trop nombreuses régions
 (phénomène de sur-segmentation)
\end_layout

\begin_layout Itemize
Il est possible d'
\series bold
imposer les minima
\series default
 à appliquer à l'image, soit manuellement, soit sur la base de la dynamique
 des niveaux de gris des régions
\end_layout

\begin_layout Itemize
les régions obtenues peuvent éventuellement faire l'objet de 
\series bold
post-traitements
\series default
 : division de particules non convexes, fusion de régions correspondant
 à une même cellule...
\end_layout

\begin_layout Subsection
Application sur une image gradient
\end_layout

\begin_layout Standard
La ligne de partage des eaux est souvent utilisée sur des images de gradient
 pour identifier le contour d'objets qui apparaissent contrastés par rapport
 au fond.
 On commence par calculer le gradient de l'image, par exemple à l'aide de
 filtres de Prewitt ou de Sobel.
 On calcule ensuite la norme du gradient (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-gradient"

\end_inset

-b).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/refImages/rice.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/grains-grad.tif
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/segment/grains-ovr.tif
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Watershed-gradient"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Détection de contours par ligne de partage des eaux
\end_layout

\end_inset

Application de la ligne de partage des eaux sur le gradient d'une image
 pour détecter le contour des grains.
 (a) image d'origine (b) norme du gradient (représenté en inversé) (c) résultat
 de la ligne de partage des eaux superposée sur l'image d'origine.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
En filtrant un peu (ici : détection et imposition des minima étendus), on
 obtient une ligne de partage des eaux sur l'image gradient qui correspond
 aux contours des particules (ici des grains) dans l'image (
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Watershed-gradient"

\end_inset

-c).
 
\end_layout

\begin_layout Standard
On note sur la figure exemple que la segmentation s'affranchit très bien
 de la variation d'intensité du fond.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Contours actifs (
\begin_inset Quotes cld
\end_inset

Snake
\begin_inset Quotes crd
\end_inset

)
\end_layout

\begin_layout Subsection
Snakes
\end_layout

\begin_layout Subsection
Level sets
\end_layout

\end_inset


\end_layout

\begin_layout Section
Détection de structures (feature detection)
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
on ajoute quelques a priori sur ce que l'on cherche.
 On commence aussi à évoquer le multi-échelles.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Détection de spots
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Détection des coins
\end_layout

\begin_layout Standard
Plutôt que des bords, on cherche parfois à extraire les extrémités, ou les
 coins des structures observées.
 Pour cela, le 
\series bold
détecteur de coins de Harris
\series default
 est une des méthodes les plus populaires.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Détection de structures linéiques (Franji and Co)
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Détection de lignes ou de cercles
\end_layout

\begin_layout Standard
Il est possible d'identifier des structures linéaires ou circulaires dans
 les images, en utilisant la 
\series bold
transformée de Hough
\series default
.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
application à la détection du centre de billons de bois.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Ajustement de modèles
\end_layout

\begin_layout Plain Layout
On formalise les contraintes sur la forme et sur l'agencement des objets
 que l'on cherche, et on cherche le meilleur compromis entre le respect
 des contraintes et l'adéquation aux données.
\end_layout

\begin_layout Itemize
exemples from Descombes
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Analyse
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
trucs en plus : 
\end_layout

\begin_layout Itemize
analyse des intensités ou des couleurs, 
\end_layout

\begin_deeper
\begin_layout Itemize
voire la colocalisation
\end_layout

\end_deeper
\begin_layout Itemize
régions d'intérêt 
\end_layout

\begin_layout Itemize
organisations spatiales
\end_layout

\begin_deeper
\begin_layout Itemize
motifs de points
\end_layout

\begin_layout Itemize
intensités en fonction de distances
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
L'analyse d'images a pour but d'extraire des paramètres quantitatifs des
 images.
 Ces paramètres peuvent ensuite être soumis à une analyse statistique plus
 poussée, et/ou être confrontés à d'autres paramètres issus de méthodes
 d'acquisition complémentaires : tests mécaniques, analyses sensorielles,
 analyses physico-chimiques...
\end_layout

\begin_layout Standard
On distingue différentes familles de méthodes en fonction du type d'image
 à analyser.
 
\end_layout

\begin_layout Itemize
L'analyse de la 
\series bold
morphologie de particules
\series default
 est la démarche qui vient souvent en premier lieu à l'esprit.
 Elle consiste à déterminer, pour chaque particule identifiée dans l'image,
 des paramètres décrivant le plus souvent la taille, la forme, ou les statistiqu
es des niveaux de gris de la particule
\end_layout

\begin_layout Itemize
Pour des 
\series bold
images 3D
\series default
, l'analyse des particules est un peu plus difficile, notamment du fait
 qu'il est plus compliqué d'observer entièrement un nombre significatif
 de particules sur une même image.
\end_layout

\begin_layout Itemize
Dans certains cas, la structure d'intérêt se prête mal à une description
 par un ensemble de particules : les solides alvéolaires comme la mie de
 pain, les structures ramifiées...
 Des 
\series bold
paramètres géométriques globaux
\series default
 permettent néanmoins une description qui peut s'avérer pertinente.
\end_layout

\begin_layout Itemize
Un problème particulièrement ardu est la détermination de paramètres 3D
 quand on ne dispose que d'images de coupes planes 2D.
 On entre ici dans le champ de la 
\series bold
stéréologie
\series default
, une discipline qui mêle géométrie stochastique et statistiques.
\end_layout

\begin_layout Itemize
Enfin, de nombreuses applications fournissent des images dans lesquelles
 les structures d'intérêt ne peuvent être clairement identifiées.
 Dans ce cas, les méthodes d'
\series bold
analyse de texture d'image
\series default
 peuvent se révéler fructueuses.
\end_layout

\begin_layout Standard
Il peut être utile de rappeler que dans tous les cas, il est nécessaire
 de disposer de la calibration spatiale de l'image.
 Cette calibration peut être fournie par le dispositif d'acquisition (microscope...
).
 Dans le cas inverse, l'utilisation de mires de calibration permet de connaître
 a posteriori la résolution des images.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Analyse des intensités et des couleurs
\end_layout

\begin_layout Plain Layout
Une analyse relativement simple consiste à comparer les intensités moyennes
 dans différentes images ou différentes régions.
 Il est alors primordial de s'assurer que les intensités mesurées ne varient
 pas en fonction des conditions d'acquisition, ou alors que ces variations
 seront négligeables devant le nombre de répétitions des acquisitions.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Morphologie de particules
\end_layout

\begin_layout Standard
De nombreuses images présentent un nombre parfois important de particules
 facilement identifiables : cellules dans un tissu, différents échantillons
 pris en photographie, scans de feuilles de plantes...
 Les questions qui se posent sont de déterminer des paramètres morphologiques
 pertinents permettant par exemple de discriminer des populations d'individus
 
\begin_inset CommandInset citation
LatexCommand citep
key "Coster1989"
literal "true"

\end_inset

.
 Ces paramètres peuvent ensuite être utilisés pour des tests statistiques,
 ou pour classifier les particules en différentes classes.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
autres paramètres :
\end_layout

\begin_layout Itemize
rayons des cercles inscrits (-> 
\begin_inset Quotes cld
\end_inset

épaisseur
\begin_inset Quotes crd
\end_inset

) et circonscrit
\end_layout

\begin_layout Itemize
on a aussi la notion de corde interne (diamètre de Martin ?) : longueur
 du plus grand segment de droite inscrit dans la particule
\end_layout

\begin_layout Itemize
analyse de Fourier
\end_layout

\begin_layout Itemize
paramètres directionnels
\end_layout

\begin_layout Plain Layout
Trucs en plus :
\end_layout

\begin_layout Itemize
classification d'objets 
\end_layout

\begin_layout Itemize
diagrammes de forme
\end_layout

\begin_layout Itemize
ramifications, branchements, fibrillations...
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Aire et périmètre
\end_layout

\begin_layout Subsubsection
Aire
\end_layout

\begin_layout Standard

\series bold
L'aire
\series default
 permet de caractériser la taille d'une particule.
 C'est un des paramètres les plus simples à mesurer : pour une particule
 entièrement visible, il suffit de compter le nombre de pixels qui la composent,
 et de multiplier par l'aire d'un pixel.
\end_layout

\begin_layout Standard
On préfère parfois d'autres paramètres, qui en sont souvent dérivés :
\end_layout

\begin_layout Description
le
\begin_inset space ~
\end_inset

diamètre
\begin_inset space ~
\end_inset

équivalent, qui correspond au diamètre qu'aurait une particule sphérique
 ayant la même aire
\end_layout

\begin_layout Description
le
\begin_inset space ~
\end_inset

logarithme
\begin_inset space ~
\end_inset

de
\begin_inset space ~
\end_inset

l'aire, qui a tendance a avoir une distribution plus symétrique que pour
 l'aire (on a souvent plus de petites particules que de grosses)
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
demo possible pour l'image de maïs après segmentation
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Périmètre
\end_layout

\begin_layout Standard
Après l'aire, 
\series bold
le périmètre
\series default
 est souvent le deuxième paramètre que l'on cherche à mesurer sur une particule.
 Malheureusement, il existe plusieurs méthodes pour mesurer le périmètre,
 et elles ne sont pas toujours implémentées de manière identique selon les
 logiciels.
\end_layout

\begin_layout Standard
Une méthode naïve pour mesurer le périmètre consiste à 
\series bold
compter le nombre de pixels 
\series default
composant la frontière de la particule (voir la figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mesure-Perimetre-Naive"

\end_inset

).
 Cette méthode n'est cependant pas très précise.
 Si on considère par exemple l'image d'un disque, on obtiendra la même mesure
 de périmètre pour le disque que pour le carré contenant le disque, et ceci
 quelle que soit la résolution de l'image.
 On peut imaginer des pondérations pour les pixels diagonaux, mais cela
 ne résout pas le problème.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/discreteDisk2.png
	lyxscale 75
	height 5cm

\end_inset


\begin_inset Graphics
	filename images/analyse/crofton-principle-2d.png
	lyxscale 75
	height 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Mesure-Perimetre-Naive"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Mesure du périmètre
\end_layout

\end_inset

Mesure du périmètre d'un objet binaire.
 Une méthode imprécise consiste à compter les pixels du bord : on obtient
 le même périmètre pour le cercle et pour le carré contenant le cercle.
 Une méthode plus précise consiste à compter les intersections avec des
 droites d'orientations variées.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
La 
\series bold
méthode de Crofton
\series default
 consiste à compter le nombre d'intersections entre la structure et un ensemble
 de droites d'orientations variées.
 On peut en effet démontrer que le nombre d'intersections est proportionnel
 au nombre de droites et au périmètre de la structure d'intérêt.
 Pour des images numériques, on utilise des droites horizontales, verticales,
 et éventuellement diagonales.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Rajouter un tit truc pour montrer que c'est mieux
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Circularité
\end_layout

\begin_layout Standard
Le périmètre et l'aire sont deux paramètres mesurant la taille des particules.
 Afin de s'affranchir des l'effet de la taille, on utilise parfois le rapport
 de ces deux paramètres, afin de définir un 
\series bold
facteur de circularité
\series default
 (appelé aussi plus simplement mais de manière plus ambigue 
\begin_inset Quotes cld
\end_inset

facteur de forme
\begin_inset Quotes crd
\end_inset

, ou encore 
\begin_inset Quotes cld
\end_inset

déficit isopérimétrique
\begin_inset Quotes crd
\end_inset

) :
\begin_inset Formula 
\[
f=4\pi\frac{A}{p^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
La constante 
\begin_inset Formula $4\pi$
\end_inset

 permet de normaliser le paramètre entre 
\begin_inset Formula $0$
\end_inset

 (particule très allongée ou très rugueuse) et 
\begin_inset Formula $1$
\end_inset

 (particule circulaire et donc très compacte).
 Du fait des erreurs qui peuvent être faites sur les mesures (notamment
 de périmètre), il peut arriver que la valeur calculée pour la circularité
 dépasse 1, il faut donc dans ce cas tronquer le résultat.
 On considère parfois l'inverse de la circularité, ce qui permet d'avoir
 un paramètre plus facilement interprétable.
 Un autre inconvénient de ce paramètre est qu'il combine deux informations
 : la rugosité de la frontière, et l'allongement de la particule.
 L'interprétation des résultats peut donc être difficile.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
figure pour la difficulté d'interprétation du facteur de forme : 3 particules
 avec même f : un baton, une croix, un S
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Diamètre de Féret
\end_layout

\begin_layout Standard
Un paramètre souvent utilisé est la mesure du 
\series bold
diamètre de Féret
\series default
.
 Elle consiste à mesurer l'étendue spatiale d'une particule dans une direction
 donnée (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Diamètre-de-Féret"

\end_inset

).
 On la trouve parfois orthographiée 
\begin_inset Quotes cld
\end_inset

diamètre de Feret
\begin_inset Quotes crd
\end_inset

, ou 
\begin_inset Quotes cld
\end_inset

diamètre de Ferret
\begin_inset Quotes crd
\end_inset

, mais la version avec accent semble la plus ancienne, voir par exemple
 
\begin_inset CommandInset citation
LatexCommand citet
key "Coster1989"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/demoShape-maxFeret.png
	width 8cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Diamètre-de-Féret"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Diamètre de Féret
\end_layout

\end_inset

Diamètre de Féret d'une particule mesuré dans la direction 
\begin_inset Formula $\omega$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
reprendre image, et utiliser (1) diamètre de Feret pour une direction donnée,
 (2) diamètre min et boîte d'épaisseur minimum
\end_layout

\end_inset


\end_layout

\begin_layout Standard
En répétant la mesure pour différentes directions, on obtient une fonction
 qui associe un diamètre à une direction entre 0 et 180°.
 On peut résumer cette fonction en différents paramètres :
\end_layout

\begin_layout Itemize
diamètre de Féret maximum 
\end_layout

\begin_layout Itemize
diamètre de Féret minimum 
\end_layout

\begin_layout Itemize
diamètre de Féret dans la direction orthogonale au maximum 
\end_layout

\begin_layout Itemize
diamètre de Féret moyenné sur l'ensemble des directions (si la particule
 est convexe, on obtient une valeur proportionnelle au périmètre)
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Notion de boîtes orientées
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Cette mesure peut facilement s'étendre aux particules observées dans des
 images 3D.
\end_layout

\begin_layout Subsection
Moments géométriques et ellipse équivalente
\end_layout

\begin_layout Standard
Les moments de l'image correspondent à une intégrale sur les valeurs des
 pixels, pondérée par leur position.
 On définit le 
\series bold
moment géométrique
\series default
 de degré 
\begin_inset Formula $(p,q)$
\end_inset

 par
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
m_{p,q} & = & \sum_{x}\sum_{y}x^{p}y^{q}I(x,y)\label{eq:Moment-Geometrique-2D}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Pour une image binaire, la valeur 
\begin_inset Formula $I(x,y)$
\end_inset

 vaut 
\begin_inset Formula $1$
\end_inset

 si le point 
\begin_inset Formula $(x,y)$
\end_inset

 appartient à la particule, et 0 sinon.
 Le moment de degré 
\begin_inset Formula $(0,0)$
\end_inset

 correspond simplement à l'aire de la particule.
 Les moments 
\begin_inset Formula $m_{10}$
\end_inset

 et 
\begin_inset Formula $m_{01}$
\end_inset

, après normalisation par le moment 
\begin_inset Formula $m_{00}$
\end_inset

, correspondent aux coordonnées du 
\series bold
centroïde
\series default
, ou centre de gravité de la particule :
\begin_inset Formula 
\begin{eqnarray*}
x_{c} & = & \frac{m_{10}}{m_{00}}\\
y_{c} & = & \frac{m_{01}}{m_{00}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsubsection
Ellipse équivalente
\end_layout

\begin_layout Standard
En pratique, on utilise rarement les moments, mais plutôt des valeurs dérivées
 qui permettent de résumer l'information sur la particule.
 On utilise en général les moments d'ordre 
\begin_inset Formula $2$
\end_inset

, qui permettent de définir une ellipse équivalente ayant les mêmes moments
 que la particule.
 La longueur du grand axe et du petit axe, ainsi que l'orientation de l'ellipse,
 permettent ainsi de synthétiser la forme globale de la particule (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ellipse-d'inertie-particule"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/ellipseInertie.png
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Ellipse-d'inertie-particule"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Ellipse d'inertie d'une particule
\end_layout

\end_inset

Ellipse d'inertie d'une particule, ainsi que le centroïde et les axes principaux
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Les paramètres synthétiques obtenus sont :
\end_layout

\begin_layout Itemize
la position du centre de gravité
\end_layout

\begin_layout Itemize
la longueur du grand axe
\end_layout

\begin_layout Itemize
la longueur du petit axe
\end_layout

\begin_layout Itemize
l'orientation de l'ellipse
\end_layout

\begin_layout Itemize
facteur d'allongement (rapport des longueurs des axes), qui permet de décrire
 la forme générale de la particule (1 : forme ronde, valeur élevée : forme
 allongée)
\end_layout

\begin_layout Subsubsection
Moments normalisés et Invariants
\end_layout

\begin_layout Standard
Il est souvent plus pratique de manipuler les moments centrés :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\mu_{p,q} & = & \sum_{x}\sum_{y}\left(x-x_{c}\right)^{p}\left(y-y_{c}\right)^{q}I(x,y)\label{eq:Moments-Centres-2D}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Enfin, pour s'affranchir de l'effet de la taille de la particule on considère
 en général les moments normalisés, en divisant par le moment 
\begin_inset Formula $\mu_{00}$
\end_inset

 :
\begin_inset Formula 
\[
\bar{\mu}_{p,q}=\frac{\mu_{p,q}}{\mu_{00}^{(p+q+2)/2}}
\]

\end_inset


\end_layout

\begin_layout Standard
Il est ensuite possible de définir des paramètres normalisés, appelés invariants
, qui décrivent la forme de la particule.
 Les invariants couramment utilisés sont les invariants de Hu.
 Les invariants de Hu couramment utilisés sont au nombre de 7, et restent
 identiques (aux erreurs de discrétisation près) après translation, changement
 de taille ou rotation d'une particule donnée.
\begin_inset Formula 
\begin{eqnarray*}
H_{1} & = & \bar{\mu}_{20}+\bar{\mu}_{02}\\
H_{2} & = & \left(\bar{\mu}_{20}-\bar{\mu}_{02}\right)^{2}+4\bar{\mu}_{11}^{2}\\
H_{3} & = & \left(\bar{\mu}_{30}-3\bar{\mu}_{12}\right)^{2}+\left(\bar{\mu}_{21}-\bar{\mu}_{03}\right)^{2}\\
H_{4} & = & \left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}+\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\\
H_{5} & = & \left(\bar{\mu}_{30}-3\bar{\mu}_{12}\right)\cdot\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)\cdot\left[\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}-3\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\right]\\
 &  & +\left(3\bar{\mu}_{21}-\bar{\mu}_{03}\right)\cdot\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)\cdot\left[3\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}-\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\right]\\
H_{6} & = & \left(\bar{\mu}_{20}+\bar{\mu}_{02}\right)\cdot\left[\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}-\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\right]\\
 &  & +4\bar{\mu}_{11}\cdot\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}\cdot\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\\
H_{7} & = & \left(3\bar{\mu}_{21}-\bar{\mu}_{03}\right)\cdot\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)\cdot\left[\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}-3\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\right]\\
 &  & +\left(3\bar{\mu}_{12}-\bar{\mu}_{30}\right)\cdot\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)\cdot\left[3\left(\bar{\mu}_{30}+\bar{\mu}_{12}\right)^{2}-\left(\bar{\mu}_{21}+\bar{\mu}_{03}\right)^{2}\right]
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Les notations ci-dessus proviennent de 
\begin_inset CommandInset citation
LatexCommand citet
key "Burger2008"
literal "true"

\end_inset

.
 Voir aussi 
\begin_inset CommandInset citation
LatexCommand citet
key "Wood1996"
literal "true"

\end_inset

.
 Comme la plage de variation de ces paramètres est souvent différente, on
 utilise couramment leur logarithme.
 
\end_layout

\begin_layout Subsection
Paramètres géodésiques
\end_layout

\begin_layout Subsubsection
Diamètre géodésique
\end_layout

\begin_layout Standard
Pour des particules de forme complexe, le diamètre ne reflète pas vraiment
 la taille réelle de la particule.
 On peut chercher à caractériser la plus grande distance géodésique (calculée
 en restant à l'intérieur de la particule) entre deux points appartenant
 à la particule.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/longueurGeodesique.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Diamètre-Geodesique"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Diamètre géodésique 
\end_layout

\end_inset

Diamètre géodésique d'une particule
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Ce paramètre est particulièrement bien adapté pour les particules non convexes,
 de forme allongées, ou très ramifiées.
 Dans ce dernier cas, le diamètre géodésique correspond à la longueur de
 la plus grande ramification.
\end_layout

\begin_layout Subsubsection
Tortuosité
\end_layout

\begin_layout Standard
Un paramètre morphologie intéressant est la tortuosité, que l'on peut définir
 comme le rapport de la longueur géodésique et du diamètre de Féret de la
 particule.
 Ce paramètre vaut environ 1 pour des formes convexes, et augmente pour
 des formes allongées.
\end_layout

\begin_layout Subsubsection
Allongement géodésique
\end_layout

\begin_layout Standard
Il est possible de calculer un 
\series bold
allongement géodésique
\series default
 de la particule.
 On peut utiliser plusieurs formules :
\end_layout

\begin_layout Itemize
le rapport du carré de la longueur géodésique et de l'aire de la particule
 
\end_layout

\begin_layout Itemize
le rapport de la longueur géodésique et de l'épaisseur de la particule
\end_layout

\begin_layout Subsection
Compacité
\end_layout

\begin_layout Standard
La 
\series bold
compacité 
\series default
(appelée aussi 
\series bold
convexité
\series default
, ou encore 
\series bold
solidité
\series default
) permet de discriminer les particules globalement convexes de celles ayant
 une forme plus complexe.
 On commence par calculer l'enveloppe convexe de la particule, qui correspond
 au plus petit domaine convexe contenant entièrement la particule d'origine.
 La compacité est alors définie comme le rapport de l'aire de la particule
 sur l'aire de son enveloppe convexe.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/convexity.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Compacité"

\end_inset

Compacité d'une particule
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Les particules convexes ou quasi-convexes auront une compacité proche de
 1, tandis que des particules aux formes complexes verront leur compacité
 décroître.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
extension : 
\begin_inset Quotes cld
\end_inset

arbre des concavités
\begin_inset Quotes crd
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Comparaison des facteurs de forme
\end_layout

\begin_layout Standard
Le tableau 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Facteur-de-forme"

\end_inset

 présente les valeurs de quelques facteurs de forme pour des particules
 ayant des formes contrastées : un œuf, une ellipse, une forme étoilée,
 une fibre courbe.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename images/analyse/egg.png
	width 2cm

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename images/analyse/ellipse.png
	width 2cm

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename images/analyse/starfish.png
	width 2cm

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename images/analyse/snake.png
	width 2cm

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
œuf
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ellipse
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
étoile
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fibre
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Circularité
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.966
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.834
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.395
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.280
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Compacité
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.973
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.961
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.685
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.556
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Allongement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.99
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.00
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.63
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tortuosité
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.06
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.04
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1.26
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Facteur-de-forme"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Facteurs de forme de quelques particules contrastées
\end_layout

\end_inset

Facteurs de forme de quelques particules contrastées.
 Tous les paramètres présentés valent 1 dans le cas d'un disque.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On constate qu'en fonction de la nature des particules étudiées, certains
 paramètres sont plus pertinents que d'autres.
 Ainsi, la compacité de l'œuf et de l'ellipse ne permet pas de les différencier
 d'un disque, au contraire de l'allongement.
 Par contre, pour une forme étoilée, l'allongement est quasiment identique
 à celui d'un disque.
 Dans ce cas, la compacité ou la circularité sont des paramètres plus utiles.
 Enfin, pour des particules en forme de fibres, la tortuosité est un bon
 indicateur de l'allongement.
\end_layout

\begin_layout Section
Analyse de particules en 3D
\end_layout

\begin_layout Standard
On s'intéresse ici à un ensemble de particules observées en 3D.
 On dispose là aussi de plusieurs paramètres descriptifs.
 
\end_layout

\begin_layout Standard
Notons que dans de nombreux cas on observe de nombreuses particules qui
 touchent les bords.
 C'est le cas par exemple dans des images de tissus végétaux en microscopie
 confocale.
 Si on les supprime de l'analyse, on risque de perdre de l'information.
 Si on les garde, on ne mesure pas les paramètres sur la totalité des particules.
\end_layout

\begin_layout Subsection
Paramètres géométriques
\end_layout

\begin_layout Standard
Il existe quatre paramètres fondamentaux pour caractériser des particules
 ou des ensembles en 3D : le volume, la surface, l'épaisseur moyenne et
 la caractéristique d'Euler-Poincaré.
\end_layout

\begin_layout Subsubsection
Volume
\end_layout

\begin_layout Standard
Le 
\series bold
volume
\series default
 joue le même rôle que l'aire en deux dimension.
 On le mesure en comptant le nombre de pixels (ou voxels) appartenant à
 la particule, et en multipliant par le volume élémentaire d'un voxel.
\end_layout

\begin_layout Subsubsection
Aire de surface
\end_layout

\begin_layout Standard
La mesure de 
\series bold
l'aire de surface
\series default
 nécessite de prendre les mêmes précautions que pour le périmètre en 2D.
 Une première méthode consiste à calculer une représentation surfacique
 de la particule sous la forme d'un maillage triangulaire, puis à calculer
 la somme des aires de chaque triangle.
\end_layout

\begin_layout Standard
Comme pour le périmètre, il est aussi possible d'estimer la surface en utilisant
 la 
\series bold
formule de Crofton
\series default
.
 Le principe consiste à calculer le nombre d'intersections avec des droites
 discrètes dans l'image.
 On peut facilement calculer les intersections pour des ensembles de 3,
 9 ou 13 directions dans l'image.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Ajouter image pour expliquer comment mesurer surface et epaisseur moyenne
 a partir de Crofton
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Épaisseur moyenne
\end_layout

\begin_layout Standard

\series bold
L'épaisseur moyenne
\series default
 est définie pour des particules lisses comme une intégrale de courbure
 moyenne.
 En pratique, pour une particule convexe, elle est proportionnelle à la
 largeur moyenne en fonction des directions, et pour une fibre allongée,
 elle est proportionnelle à la longueur.
 C'est donc un paramètre morphologique complémentaire du volume et de la
 surface.
\end_layout

\begin_layout Standard
Il se mesure lui aussi en faisant appel à la formule de Crofton, mais cette
 fois en considérant des plans discrets dans l'image d'origine, et en mesurant
 le nombre de composantes connexes dans les plans.
\end_layout

\begin_layout Subsubsection
Caractéristique d'Euler-Poincaré
\end_layout

\begin_layout Standard

\series bold
La caractéristique d'Euler-Poincaré
\series default
 (appelée aussi nombre d'Euler, ou connexité) permet de caractériser la
 topologie d'une structure.
 C'est une valeur entière, sans dimension (c'est à dire sans unité).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analyse/caracEulerPoincare.png
	width 7cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Caractéristique d'Euler-Poincaré 3D
\end_layout

\end_inset

La caractéristique d'Euler-Poincaré d'une structure avec deux anses est
 égale à -1 (+1 pour le nombre de composantes connexes, -2 pour le nombre
 d'anses)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Pour une particule connexe, la caractéristique d'Euler-Poincaré vaut 1.
 Pour une particule avec des trous, ou des anses (comme pour une tasse à
 café), la caractéristique d'Euler-Poincaré est égale à 1 moins le nombre
 de tunnels.
 Si on a des 
\begin_inset Quotes cld
\end_inset

bulles
\begin_inset Quotes crd
\end_inset

 (espaces vides complètement à l'intérieur de la particule), on ajoute 1
 par bulle.
 Enfin, on peut aussi considérer cette caractéristique pour un ensemble
 de particules, dans ce cas elle est égale à la somme des caractéristiques
 de chaque particule individuelle.
\end_layout

\begin_layout Subsection
Paramètres de forme
\end_layout

\begin_layout Standard
Comme en 2D, il est possible de définir des paramètres de forme pour des
 particules 3D, en se basant sur des rapports de mesures de taille.
 Une première famille de paramètres de forme se base sur les rapports normalisés
 du volume V, de la surface S, et de l'épaisseur moyenne B.
 En exprimant les paramètres entre 0 et 1, la valeur 1 correspondant à une
 particule complètement sphérique, on obtient les paramètres suivants :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
f_{1} & = & 36\pi\frac{V^{2}}{S^{3}}\\
f_{2} & = & \frac{6}{\pi}\frac{V}{B^{3}}\\
f_{3} & = & \frac{1}{\pi}\frac{S}{B^{2}}
\end{eqnarray*}

\end_inset

Ces paramètres ont les mêmes défauts que le déficit isopérimétrique : ils
 sont très sensibles aux erreurs de mesures faites sur la surface ou l'épaisseur
 moyenne, et leur interprétation est difficile.
 Une autre famille de paramètres se base sur les rapports des longueurs
 des axes de l'ellipsoïde équivalent.
\begin_inset Formula 
\begin{eqnarray*}
r_{12} & = & r_{1}/r_{2}\\
r_{13} & = & r_{1}/r_{3}\\
r_{23} & = & r_{2}/r_{3}
\end{eqnarray*}

\end_inset

Un avantage des paramètres de forme basés sur l'ellipsoïde équivalent est
 qu'ils sont assez peu sensibles aux erreurs de segmentation sur la frontière
 pour décrire la forme générale de particules.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
[à voir si utile -> connais pas d'application en fait...]
\end_layout

\begin_layout Plain Layout
ref Andrey...
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Subsection
Paramètres statistiques (moments)
\end_layout

\begin_layout Subsection
histogramme des courbures
\end_layout

\end_inset


\end_layout

\begin_layout Section
Microstructure
\end_layout

\begin_layout Standard
Dans certains types d'images on observe une structure plus complexe qu'il
 est difficile d'assimiler à un ensemble de particules individuelles : mie
 de pain, mousses solides, agrégats...
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
trouver image exemple.
 
\end_layout

\begin_layout Plain Layout
Image de tomate ? mie de pain ? fibres de bois de Bordeaux ? gels laitiers
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Subsection
Géométrie spécifique
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Il est possible de quantifier des images de microstructure en adaptant certains
 paramètres morphométriques classiques.
 En 2D, on utilise par exemple le périmètre et l'aire, mais on ne mesure
 que la fraction de structure ou de frontière visible dans les images, que
 l'on ramène à l'aire de la zone observée.
 Il est ainsi possible de mesurer une 
\series bold
densité de périmètre
\series default
 ou une 
\series bold
densité d'aire
\series default
.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
exemple sur tomate
\end_layout

\end_inset


\end_layout

\begin_layout Standard
La même stratégie est envisageable en 3D.
 On mesure cette fois la densité volumique, la densité de surface, ou encore
 la densité d'épaisseur moyenne.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Covariance 
\end_layout

\begin_layout Subsection
Granulométries binaires 
\end_layout

\begin_layout Subsection
Orientation locale
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Section
Stéréologie : passage du 2D au 3D
\end_layout

\end_inset


\end_layout

\begin_layout Section
Analyse de texture
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Longueurs de plage
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Matrices de cooccurence
\end_layout

\begin_layout Standard
Démarche :
\end_layout

\begin_layout Enumerate
Choix d'un vecteur (ex : +2;-1)
\end_layout

\begin_layout Enumerate
Construction des matrices
\end_layout

\begin_layout Enumerate
Paramètres synthétiques
\end_layout

\begin_layout Standard
Possibilité d'étudier l'évolution de certains paramètres quand on fait varier
 la longueur du vecteur d'étude.
\end_layout

\begin_layout Subsection
Granulométrie
\end_layout

\begin_layout Standard
Idée : appliquer des filtres définis par un élément structurant de forme
 donnée, et faire varier la taille du filtre.
 On évalue ensuite les variations de volume de niveaux de gris pour construire
 une courbe granulométrique, qui décrit la texture visuelle de l'image.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Subsection
Orientation locale
\end_layout

\end_inset


\end_layout

\begin_layout Section
Graphe d'adjacence des régions
\end_layout

\begin_layout Standard
Lorsque l'image représente un ensemble de régions disjointes mais adjacentes,
 on peut vouloir décrire les relations de voisinage entre les régions.
 Une première classe d'applications concerne les algorithmes de division-fusion
 (
\shape italic
\lang english
split-and-merge
\shape default
\lang french
) : on procède d'abord à une division très fines de l'image (
\shape italic
\lang english
quad-tree
\shape default
\lang french
, ligne de partage des eaux...), puis on cherche à fusionner les régions adjacentes.
 
\end_layout

\begin_layout Standard
Pour des applications d'analyse, on peut vouloir utiliser la topologie du
 graphe (nombre moyen de voisins...) pour décrire l'organisation spatiale des
 objets dans l'image (voir la figure suivante pour un exemple de description
 de cellules végétales).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binaires/maize-clsm-watDyn10.png
	width 6cm

\end_inset


\begin_inset Graphics
	filename images/binaires/maize-clsm-rag.png
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Graphe d'adjacence des régions
\end_layout

\end_inset

Segmentation d'une image d'entrenoeud de maïs, et graphe d'adjacence des
 régions montrant les relations de voisinages entre les cellules.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
L'algorithme le plus simple pour obtenir le graphe d'adjacence consiste
 à considérer chaque région tour à tour, à calculer la dilatation morphologique
 de cette région avec un élément structurant arbitraire, et à calculer l'interse
ction du dilaté avec les régions voisines.
 En répétant l'opération pour chaque région, on arrive à reconstruire le
 graphe d'adjacence des régions.
 
\end_layout

\begin_layout Standard
Une autre solution consiste à parcourir les lignes horizontales et verticales
 de l'image, et à détecter les transitions entre deux régions différentes.
 Dans le cas d'une segmentation produisant une frontière entre les régions,
 il faut évidemment tenir compte de l'épaisseur de cette frontière.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Glossaire ?
\end_layout

\begin_layout Plain Layout
Index ?
\end_layout

\end_inset


\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "tutoImage"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
